<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Python RESTful APIs running on containers, the easy way - EA1HET / 0x30.io</title><meta name="description" content="Writing a public article can be really difficult task. Trying to connect with the readers of all kinds can be tricky. Offer something for reading both to advanced and entry users on technology, bearing in mind how fast the technology ecosystems changes is definitely a&hellip;"><meta name="robots" content="index, follow"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://0x30.io/python-restful-apis-running-on-containers-the-easy-way/"><link rel="amphtml" href="https://0x30.io/amp/python-restful-apis-running-on-containers-the-easy-way/"><link rel="alternate" type="application/atom+xml" href="https://0x30.io/feed.xml"><link rel="alternate" type="application/json" href="https://0x30.io/feed.json"><link rel="shortcut icon" href="https://0x30.io/media/website/favicon.ico" type="image/x-icon"><style>:root {
                --body-font: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
                --heading-font: var(--body-font);
                --post-entry-font: var(--body-font);
                --logo-font: var(--body-font);
                --menu-font: var(--body-font)
            }</style><link rel="stylesheet" href="https://0x30.io/assets/css/style.css?v=e9a38a2269509c87531ce90cff8eb978"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://0x30.io/python-restful-apis-running-on-containers-the-easy-way/"},"headline":"Python RESTful APIs running on containers, the easy way","datePublished":"2018-09-28T23:43","dateModified":"2019-08-12T00:17","image":{"@type":"ImageObject","url":"https://0x30.io/media/posts/11/1_wVrgeExYzpDWBma8g6q5TA.png","height":553,"width":1400},"description":"Writing a public article can be really difficult task. Trying to connect with the readers of all kinds can be tricky. Offer something for reading both to advanced and entry users on technology, bearing in mind how fast the technology ecosystems changes is definitely a&hellip;","author":{"@type":"Person","name":"Jonathan Gonzalez"},"publisher":{"@type":"Organization","name":"Jonathan Gonzalez"}}</script><script src="https://0x30.io/assets/js/ls.object-fit.min.js?v=cdedd9262bb7b299d0ebe1deaea5b924"></script><script async src="https://0x30.io/assets/js/lazysizes.min.js?v=d8513e7860f747ccf55c52308943beab"></script></head><body><header class="topbar" id="js-header"><div class="topbar__inner"><a class="logo" href="https://0x30.io/">EA1HET / 0x30.io</a><nav class="navbar"><button class="navbar__toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://0x30.io/" title="Home" target="_self">Home</a></li><li class="has-submenu"><span class="is-separator" aria-haspopup="true">Professional</span><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://0x30.io/tags/cybersecurity/" target="_self">CyberSecurity</a></li><li><a href="https://0x30.io/tags/devops/" target="_self">DevOps</a></li><li><a href="https://0x30.io/tags/data/" target="_self">Data</a></li></ul></li><li class="has-submenu"><span class="is-separator" aria-haspopup="true">Amateur</span><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://0x30.io/ham-radio-software/" target="_self">Ham Radio software</a></li><li><a href="https://0x30.io/tags/iot/" target="_self">IoT</a></li></ul></li><li><a href="https://0x30.io/ham-radio/" target="_self">Ham Radio</a></li><li><a href="https://0x30.io/about-me/" target="_self">About me</a></li><li><a href="https://0x30.io/feed" target="_self">Feed</a></li></ul></nav></div></header><div class="content"><div class="infobar"><div class="infobar__update">Last Updated: <time datetime="2019-11-18T04:47">18/11/2019</time></div><div class="infobar__search"><form action="https://0x30.io/search.html"><input type="search" name="q" placeholder=" search..."> <button type="submit" aria-label="Search"><svg width="15px" height="14px"><use xlink:href="https://0x30.io/assets/svg/svg-map.svg#search"/></svg></button></form></div></div><main class="main"><article class="post"><figure class="post__featured-image" style="padding-bottom: calc(553/1400 * 100%)"><img class="lazyload" data-src="https://0x30.io/media/posts/11/1_wVrgeExYzpDWBma8g6q5TA.png" data-srcset="https://0x30.io/media/posts/11/responsive/1_wVrgeExYzpDWBma8g6q5TA-xs.png 300w ,https://0x30.io/media/posts/11/responsive/1_wVrgeExYzpDWBma8g6q5TA-sm.png 480w ,https://0x30.io/media/posts/11/responsive/1_wVrgeExYzpDWBma8g6q5TA-md.png 768w ,https://0x30.io/media/posts/11/responsive/1_wVrgeExYzpDWBma8g6q5TA-lg.png 1024w ,https://0x30.io/media/posts/11/responsive/1_wVrgeExYzpDWBma8g6q5TA-xl.png 1360w ,https://0x30.io/media/posts/11/responsive/1_wVrgeExYzpDWBma8g6q5TA-2xl.png 1600w" data-aspectratio="2.5316455696202533" data-sizes="auto" alt="" height="553" width="1400"></figure><header class="u-header post__header"><h1>Python RESTful APIs running on containers, the easy way</h1><div class="u-header__meta u-small"><img class="lazyload u-header__avatar" data-src="https://0x30.io/media/website/avatar_010-150x150.png" alt="Jonathan Gonzalez"><div><a href="https://0x30.io/authors/ea1het/" title="Jonathan Gonzalez">Jonathan Gonzalez</a> <time datetime="2018-09-28T23:43">28/09/2018 </time><a href="https://0x30.io/tags/devops/" class="u-tag u-tag--1">DevOps</a></div></div></header><div class="post__entry u-inner"><p id="f0bc" class="gk gl dg bt bs di mi nh mk ni mm nj mo nk mq nl go">Writing a public article can be really difficult task. Trying to connect with the readers of all kinds can be tricky. Offer something for reading both to advanced and entry users on technology, bearing in mind how fast the technology ecosystems changes is definitely a challenge. But, on the other hand, if no one writes about his/her story, at the end of the day, nothing is written. So, I’ll try to describe here a personal situation I had some time ago. Can or cannot be fitted to today, but at least, this was a real use case. Let’s start from the very beginning.</p><h2 id="0592" class="gk gl dg bt bs di mi mj mk ml mm mn mo mp mq mr go"><strong class="bi">Table of Contents</strong></h2><ol><li><em class="ng">Why Python?</em></li><li><em class="ng">Which tools do I use to program in Python?</em></li><li><em class="ng">Microservices and Python</em></li><li><em class="ng">What a microservice looks like in Python?</em></li><li><em class="ng">Structure of a Python microservice</em></li><li><em class="ng">An example “echo” microservice in Python</em></li><li><em class="ng">Testing and analyzing the code</em></li><li><em class="ng">Dockerfile: the containerization process</em></li></ol><h2 id="0ec3" class="gk gl dg bt bs di mi nh mk ni mm nj mo nk mq nl go">Why Python?</h2><p id="a8f7" class="ms mt dg bt mu b mv mw mx my mz na nb nc nd ne nf" data-selectable-paragraph="">For a security practitioner (what is my case), Python represents more than a simple interpreted language. Python is a Swiss knife. It is present from code snippets, to Wireshark sniffer as dissectors to full GUI applications or front-ends.</p><p id="072f" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">If your skills allow you to confront programming, or at least if you can review and modify code, Python it’s the screwdriver that will allow you to handle all the cloud/systems/applications/software/security machinery without a huge effort. Serve as an example the fact that AWS and GCP, among others, are using it heavily to build its cloud offering and tool chain. Even we have it in use in the house, with <a href="http://www.ansible.com/" class="bc co nr ns nt nu">Ansible</a>, a configuration management and orchestration engine built on top of Python.</p><p id="1d4e" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">With the current market trends, that imposes an API-first directive, and the free of choice in the selection of the programming language, Python is probably one of the most flexible tools for an enterprise architect. It’s powerful, it’s relatively simple to learn (the learning curve is not so hard), it’s really well documented, can be used naked, through micro-frameworks or with fat-frameworks, and surely the most important detail, has a magnificent community around.</p><p id="fb64" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">Personally, and this is a matter of likes and dislikes, I prefer to use Python the most naked I can, but, without losing my time in rather generic and very low-level actions. For that reason, and in direct dependency of the type of software piece that needs to be written, my first option is to use Python with a <strong class="mu nv">micro-framework</strong>. Among the available ones, my preference is <a href="http://flask.pocoo.org/" class="bc co nr ns nt nu"><strong class="mu nv">Flask</strong></a>. Flask allows me to program in Python very low level, as I want, but, at the same time, it allows me to obviate all the hard work needed for generic things, like in example, handle an HTTP or TCP connection. Connection is handled by the micro-framework, but, If I want to interact with the session yet I can do it. That’s fantastic. It allows me get concentrated on programming the business logic and I only need to mess with the very low-level actions if I really want or need.</p><h2 id="a7c2" class="gk gl dg bt bs di mi nh mk ni mm nj mo nk mq nl go">WHICH TOOLS DO I USE TO PROGRAM IN PYTHON?</h2><p id="3fd0" class="ms mt dg bt mu b mv mw mx my mz na nb nc nd ne nf" data-selectable-paragraph="">Probably, one of the most asked question: Which tools do you use when you do program? There’s no simple, single, valid answer here. Again, this is a matter or likes and dislikes, but, as I need to present the tools you later are going to see in this article’s screenshots, this is the list of tools that you will see:</p><p id="1f83" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">· <a href="https://www.python.org/downloads/" class="bc co nr ns nt nu">Python interpreter</a>, currently in version 3.7<br>· <a href="https://www.jetbrains.com/pycharm/download" class="bc co nr ns nt nu">PyCharm</a> Community IDE.<br>· <a href="https://www.getpostman.com/" class="bc co nr ns nt nu">Postman</a> API Development Environment.<br>· <a href="https://git-fork.com/" class="bc co nr ns nt nu">Fork</a> git client or Atlassian’s <a href="https://www.sourcetreeapp.com/" class="bc co nr ns nt nu">SourceTree</a> git client.<br>· <a href="https://www.sequelpro.com/" class="bc co nr ns nt nu">Sequel Pro</a> (Mac) or <a href="https://www.webyog.com/product/sqlyog" class="bc co nr ns nt nu">SQLYog</a> Community Edition (Windows, Linux).<br>· <a href="https://www.mozilla.org/en-US/firefox/developer/" class="bc co nr ns nt nu">Firefox Developer Edition</a>.<br>· <a href="https://store.docker.com/" class="bc co nr ns nt nu">Docker Community Edition</a>, stable channel.</p><p id="7645" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">All the above tools are conscientiously selected, as all of them (mostly) are multi-platform (Windows, Linux, Mac).</p><h2 id="d561" class="gk gl dg bt bs di mi nh mk ni mm nj mo nk mq nl go"><strong class="bi">MICROSERVICES AND PYTHON</strong></h2><p id="6feb" class="ms mt dg bt mu b mv mw mx my mz na nb nc nd ne nf" data-selectable-paragraph="">I know that you already know what a microservice is, but, I would like to define it again following a less common way:</p><p id="d6b8" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">· Microservices are the highest exponent of a flexible software architecture.<br>· Microservices are the empiric demonstration that software can be delivered:<br>o Being strongly modularized.<br>o Providing easy replaceability capabilities.<br>o Enabling sustainable development efforts.<br>o Simplifying legacy software refactory, rearchitecture, rebuild and replacement capabilities.<br>o Speeding time to market (this is an interesting topic that can be worth of a single article illustrating the reasons and procedures).<br>o Enabling independent scaling.<br>o Providing free of choice of technologies.<br>o Finally, all of the above, but on a <strong class="mu nv">Continuous Delivery</strong> manner.<br>· Microservices are typically developed by two-pizza teams (6–8 people at most).<br>· Microservices has no more than few hundred lines of code, let’s say ~ 200 lines at most. We should not stick to this, but, if you want to use “Lines of Code” (LoC) metric in order to determine how fast can be a microservice architecture deployment, as a rough example, think for a while a good programmer typically writes a range of 10 to 30 good lines of code per day. There’s an explanation for this: depending on the language, and specially with interpreted languages, a single line of Python requires about 40% more mental load compared with a single line of C, Java, JavaScript or CSS and probably it implements at least twice as much functionality. I’ll resume it for you: <strong class="mu nv">it’s blazing fast.<br></strong>· Microservices are totally decoupled among them. Databases, typically used in the software industry as a coupling mechanism, here are only an implementation detail.<br>· Microservices require a test-oriented development approach (like DDD, TDD, ATDD, BDD) to maximize its capacity of use and reduce coding errors.<br>· Microservices can be versioned at will, meanwhile a common interface is available (an API).<br>· Microservices can be written on different languages. Meanwhile they can interact each other using a common interface (an API) there’s no problem.</p><h2 id="1e25" class="gk gl dg bt bs di mi nh mk ni mm nj mo nk mq nl go"><strong class="bi">WHAT A MICROSERVICE LOOKS LIKE IN PYTHON</strong></h2><p id="3ac4" class="ms mt dg bt mu b mv mw mx my mz na nb nc nd ne nf" data-selectable-paragraph="">With a clear dependence on the language in use, normally a microservice is exactly that, a “micro” program acting as a server or backend service. It can be as small as the following:</p><pre class="lx ly lz ma mb kj iq dx"><span id="e71c" class="nw gl dg bt nx b fo ny nz s oa" data-selectable-paragraph=""><em class="ng">from flask import Flask</em></span><span id="2be7" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><em class="ng">app = Flask(__name__)</em></span><span id="f1bb" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><em class="ng">@app.route(‘/’)<br>def index():<br>    return “Hello, World!”</em></span><span id="605f" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><em class="ng">app.run(debug=True)</em></span></pre><p id="8fa5" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">Let’s examine the above code:</p><p id="f005" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph=""><em class="ng">from flask import Flask</em></p><p id="2cbf" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">This is a python import directive. Flask is a micro-framework, thus is, a set of python files written by other that we want to import into our main programme file. It’s necessary to use the Flask micro framework.</p><p id="05c1" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph=""><em class="ng">app = Flask(__name__)</em></p><p id="b987" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">Here we declare that our app is going to be a Flask app. The special operand __name__ is equal to the name of the file where we are writing the code, in our case, app.py</p><p id="ce11" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph=""><em class="ng">@app.route(‘/’)</em></p><p id="721b" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">This is a decorator. Decorators are professional programmer’s technique to remove unwanted code from screen, hiding pieces of code in libraries. In this case, this decorator belongs to the Flask micro-framework libraries and it allows to set a portion of the URL available for a function to execute its code.</p><p id="211c" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph=""><em class="ng">def index():</em></p><p id="be1a" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">This statement defines a function. This function is going to be executed every time the URL route defined before by a Flask decorator is called via URL.</p><p id="2176" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph=""><em class="ng">return “Hello, World!”</em></p><p id="10ab" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">This is what is going to be sent back to the client when the route decorator path is called on a URL.</p><p id="3e59" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph=""><em class="ng">app.run(debug=True)</em></p><p id="2743" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">This is the statement that effectively runs the Python program defined before. And it will be executed with debugging details on <em class="ng">stdout</em> and <em class="ng">stderr</em>.</p><h2 id="c02b" class="gk gl dg bt bs di mi nh mk ni mm nj mo nk mq nl go"><strong class="bi">STRUCTURE OF A PYTHON MICROSERVICE</strong></h2><p id="ab8f" class="ms mt dg bt mu b mv mw mx my mz na nb nc nd ne nf" data-selectable-paragraph="">As a contrast to traditional monoliths, microservices have a very simplistic approach. Most of them are programs contained on a single file, with a short list of calls to another programs or libraries (what is called “includes”) and with a rather simple or even without folder structure.</p><p id="f66d" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">The example program we are going to build is kept for learning purposes in a repository on the public GitHub. The project is this:</p><p id="573e" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph=""><a href="https://github.com/ea1het/PythonAPIContainer" class="bc co nr ns nt nu"><strong class="mu nv">https://github.com/ea1het/PythonAPIContainer</strong></a></p><p id="7a86" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">You can clone it using one of the following two command lines:</p><p id="69ed" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">a) git clone <a href="https://github.com/ea1het/PythonAPIContainer.git" class="bc co nr ns nt nu">https://github.com/ea1het/PythonAPIContainer.git</a><br>b) git clone <a href="mailto:git@github.com:ea1het/PythonAPIContainer.git" class="bc co nr ns nt nu">git@github.com:ea1het/PythonAPIContainer.git</a></p><p id="8667" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">When you are programming larger applications on fat frameworks like Django, the folder structure, and the application configuration file, are key elements that will make your program behave smooth, or otherwise you would end up having a mess in the code. In that sense, and despite a microservice needs to be small in essence, I yet think a good folder structure, if needed, and a configuration file is a very convenient feature. Let’s see how a microservice is organized and how a configuration file looks like</p><p id="75b7" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph=""><strong class="mu nv">a)</strong> <strong class="mu nv">Folder / File structure</strong></p><p id="c25e" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">Due to the fact a microservice is small enough, in almost all cases the folder structure won’t exist. All the potential files in use will be in flat on a single folder or directory. This can be a problem or a virtue, depending on the place where you intend to run code. In example, running a microservice in AWS as a lambda function imposes the obligation to have the file with the main programme in the application’s folder root. In contrast, a very typical in Python, is the use of application factories. An application factory is a useful pattern where you create your application using a function, an object. This allows you to pass different configurations to the main program, for example for unit testing, and also allows you to run multiple instances of the same application running in the same application process. That is a nice trick senior programmers tend to use to avoid circular dependency includes and to reuse code and server resources, albeit can be difficult to understand for novice programmers. Anyway, the important point here is the fact lambda functions and application factories are almost incompatible. That will explain further decisions taken on design.</p><pre class="lx ly lz ma mb kj iq dx"><span id="4f04" class="nw gl dg bt nx b fo ny nz s oa" data-selectable-paragraph=""><em class="ng">./<br>├── .env<br>├── Dockerfile<br>├── __init__.py<br>├── app.py<br>├── boot.sh<br>├── requirements.txt<br>├── settings.py<br>└── venv</em></span></pre><p id="3696" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">The above contents aren’t compulsory “as-is”. They just reflect the way I’m creating a microservice. Let me explain what’s the usage of each file:</p><ul><li id="763a"><strong class="mu nv">.env</strong>: This is a very special file. It holds the configuration variables your program requires in order to start working. This file is special because only changing this file’s contents you can change the way your program behaves. If you configure this file properly you can use your program on QA stage and with minor adjustments only on this file your program can be ready to be deployed in production. The name represents the type of configuration strategy followed, that is environment variables. Environmental variables are one of the “12 Factor App” principles in software development. Sensible parameters should never be hardcoded in programs. Environment variable loading is a clever way to avoid hardcoding. In addition to that, the name of the file is “.env”, with a dot (“.”) at the beginning of the name. On UNIX-like systems, a file starting with a dot is a hidden file. Tools like Git, massively deployed on UNIX-like systems, won’t see a .env file (by convention) so this file won’t be staged during development, thus, avoiding the hassle to send sensible credentials to a git repository.</li><li><strong class="mu nv">Dockerfile</strong>: This file is the script that will convert this microservice written in Python into a container image that later on we can run on production with, i.e. Rancher Labs, our container orchestrator.<br><br></li><li><strong class="mu nv">__init__.py</strong>: This is a very important file in Python language. The __init__.py files are required to make Python treat the directories as containing packages; this is done to prevent directories with a common name, such as “string”, from unintentionally hiding valid modules that occur later, deeper, on the module search path. In the simplest case, __init__.py can just be an empty file or even it’s not needed (our case can be a good candidate to remove this file), but can be used to export selected portions of the package under more convenient name, hold convenience functions, etc… It can also execute initialization code for the package or set variables. If you remove the __init__.py file, Python will no longer look for submodules inside that directory, so, attempts to import one of those submodules will fail.<br><br></li><li><strong class="mu nv">app.py</strong>: This is the microservice itself. Here is where the business logic is coded.<br><br></li><li><strong class="mu nv">boot.sh</strong>: This file holds the initialization script the microservice requires when it has been converted into a container. In few words, this is the script that will be executed inside the container image once the container orchestrator, or Docker, call it into execution.<br><br></li><li><strong class="mu nv">requirements.txt</strong>: This file holds the list of dependencies your code has generated. Basically, it’s the list of additional packages your code requires in order to work as expected.<br><br></li><li><strong class="mu nv">settings.py</strong>: This file is a configurator file. It holds different execution types your program requires for, i.e. development stage, QA stage or production stage.<br><br></li><li><strong class="mu nv">venv/</strong>: This is a folder with Python’s virtual environment, where Flask and other dependencies are installed.</li></ul><p id="62e7" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph=""><strong class="mu nv">a)</strong> <strong class="mu nv">Microservice configuration file in Python</strong></p><p id="1ca8" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">As explained before, configuration files and application factories are quite typical practice for senior programmers. Unfortunately, in the scope of a microservice implementation I don’t consider essential an application factory given the fact that each microservice is going to run independently, in the form of a lambda function or container, that is going to be executed several times on an auto-scaled orchestration or choreography. For that reason, application factory pattern “per se” is not in use, albeit a configuration file with that appearance is in use.</p><p id="b2e3" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">A good configuration file follows the “12 Factor App” methodology and principles, as long as the microservice itself should do. If it’s done the right way, it will enable applications to be built with portability and resiliency when deployed to the Web. Other benefits of the “12 Factor App” are:</p><ul><li id="0c1a" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">Uses declarative formats for setup automation, to minimize time and cost for new developers joining the project.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">Have a clean contract with the underlying operating system, offering <strong class="mu nv">maximum portability</strong> between execution environments.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">Are <strong class="mu nv">suitable for deployment on modern cloud platforms</strong>, obviating the need for servers and systems administration.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">Minimize divergence or drift between development and production, enabling <strong class="mu nv">continuous deployment</strong> for <strong class="mu nv">maximum agility</strong>.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">And can scale up without significant changes to tooling, architecture, or development practices.</li></ul><p id="9719" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">Specifically, on configuration file matters, Factor III of the “12 Factor App” methodology and principles states that […] <em class="ng">configuration that varies between deployments should be stored in the environment.</em> […], so, this is what we are going to do in our configuration file, given the fact that from an architecture standpoint, <strong class="mu nv">every piece of code will always traverse, at least, 3 different stages: 1/development, 2/test and 3/production.</strong></p><p id="ceb4" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">At this point, a clarification is needed: an application’s configuration is everything that is likely to vary between named deploys. This includes, among possibly others:</p><ul><li id="78b7" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">Resource handles to the database, caches, and other backing services.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">Credentials to external services such as Amazon S3 or AAA mechanisms.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">Per-deploy values such as the canonical hostname for the deploy.</li></ul><p id="20e6" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">Applications sometimes store configuration as constants in the code. This is what is known as “hardcoding”. This is a violation of basic security measures applied in development. Accessing the code, in development, test or production, means compromising any credentials used, as well as the systems related. On the other hand, note that the definition of “configuration” does not include internal application configuration, or how coded modules are connected among them. This type of configuration does not vary between deploys, therefore, this is not what we want to control.</p><p id="b7ce" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">The “<a href="https://12factor.net/" class="bc co nr ns nt nu">12 Factor App</a>” methodology and principles propose storing configuration in <strong class="mu nv">environment variables (often shortened to env vars or env)</strong>. Env vars are easy to change between deploys without changing any code. Unlike configuration files, there is little chance of them being checked into the Git code repository accidentally (as a trick, normally they are hidden files that passes unnoticed to Git), and, unlike custom configuration files, or other configuration mechanisms such as Java System Properties, they are a language-agnostic and OS-agnostic standard. Env vars are granular controls, each fully orthogonal to other env vars. Ideally, they are never grouped together as “environments”. This is a model that scales up smoothly as the application can expands into more deploys over its lifetime. Albeit the general recommendation is good, working with thousands of developers at the same time imposes the obligation to standardize environments used in the DevSecOps pipeline. Therefore, we’ll treat the last recommendation as such, and in regard to env vars and grouped environments will be rather a “relaxed” that recommendation.</p><p id="5181" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">Finally, after all this long description, this is what a microservice configuration file looks like in Python. Pay special attention to the line in colour red:</p><pre class="lx ly lz ma mb kj iq dx"><span id="5c97" class="nw gl dg bt nx b fo ny nz s oa" data-selectable-paragraph=""><em class="ng">””” Microservice configurator file ”””<br>##<br>#<br># This file configures the microservice.<br>#<br># This microservice uses ‘dotenv’ (.env) files to get environmental<br># variables. #This is done to configure sensible parameters, like<br># database connections,application secret keys and the like. In case <br># the ‘dotenv’ file does not<br># exists, a warning is generated at run-time.<br>#<br># This application implements the ’12 Factor App’ principle:<br># </em><a href="https://12factor.net/" class="bc co nr ns nt nu"><em class="ng">https://12factor.net</em></a><em class="ng"> and </em><a href="https://12factor.net/config" class="bc co nr ns nt nu"><em class="ng">https://12factor.net/config</em></a><em class="ng"><br>#<br># Note about PyLint static code analyzer: items disabled are false <br># positives.<br>#<br>##</em></span><span id="96df" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><em class="ng"># pylint: disable=too-few-public-methods;<br># In order to avoid false positives with Flask</em></span><span id="bf94" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><em class="ng">from os import environ, path<br>from environs import Env</em></span><span id="bdfe" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><em class="ng">ENV_FILE = path.join(path.abspath(path.dirname(__file__)), ‘.env’)</em></span><span id="fe7b" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><em class="ng">if path.exists(ENV_FILE):<br>    ENVIR = Env()<br>    ENVIR.read_env()<br>else:<br>    print(‘Error: .env file not found’)<br>    exit(code=1)</em></span><span id="3431" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><em class="ng">class Config:<br>””” This is the generic loader that sets common attributes ”””<br>JSON_SORT_KEYS = False<br>DEBUG = TRUE<br>TESTING = TRUE</em></span><span id="2419" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><em class="ng">class Development(Config):<br>””” Development loader ”””<br>ENV = ‘development’<br>if environ.get(‘KEY_DEVL’):<br>    SECRET_KEY = ENVIR(‘KEY_DEVL’)<br>if environ.get(‘DATABASE_URI_DEVL’):<br>    DATABASE_URI = ENVIR(‘DATABASE_URI_DEVL’)<br>TESTING = False</em></span><span id="c283" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><em class="ng">class Testing(Config):<br>””” Testing loader ”””<br>ENV = ‘testing’<br>if environ.get(‘KEY_TEST’):<br>    SECRET_KEY = ENVIR(‘KEY_TEST’)<br>if environ.get(‘DATABASE_URI_TEST’):<br>    DATABASE_URI = ENVIR(‘DATABASE_URI_TEST’)<br>DEBUG = False</em></span><span id="b976" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><em class="ng">class Production(Config):<br>””” Production loader ”””<br>ENV = ‘production’<br>if environ.get(‘KEY_PROD’):<br>    SECRET_KEY = ENVIR(‘KEY_PROD’)<br>if environ.get(‘DATABASE_URI_PROD’):<br>    DATABASE_URI = ENVIR(‘DATABASE_URI_PROD’)<br>DEBUG = False<br>TESTING = False</em></span></pre><p id="7742" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">If you did realize the above marked coloured in red, this is a call to a hidden file named “.env” (“dot” “env”). <strong class="mu nv">A “dot” “env” file is a file holding “env vars”. Get the trick? Remember I said a file starting with a “dot” is a hidden file, a file that Git does not recognize? Hey! You got it know!</strong></p><p id="22fe" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">This “dot” “env” file, and not the “configuration file” listed before, is the real configuration file holding environmental variables as the “12 Factor App” defines. That’s the reason because before I said the […]<em class="ng"> recommendation on env vars and grouped environments will be “relaxed” in most cases.</em></p><p id="00aa" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">The content of this “dot” “env” file holding env vars is, for example, like this:</p><pre class="lx ly lz ma mb kj iq dx"><span id="0475" class="nw gl dg bt nx b fo ny nz s oa" data-selectable-paragraph=""><em class="ng">#<br>#<br># This is the configuration file for this microservice<br>#<br># =================================================================<br>#<br># MODE_COMFIG variable will affect the way the application is run.<br># Available running modes are:<br>#<br># — Development<br># — Testing<br># — Production<br>#<br>export MODE_CONFIG = ‘Production’<br>export KEY_PROD = ‘example–0000–7890-aaaa-54a063e6d5a3’<br>export KEY_DEVL = ‘example-1111–7890-bbbb-5ddc2947910c’<br>export KEY_TEST = ‘example-2222–7890-cccc-0da6c41293a8’<br>export DATABASE_URI_PROD = ‘mysql+pymysql://user:pass@127.0.0.1:3306/database’<br>export DATABASE_URI_DEVL = ‘mysql+pymysql://user:pass@127.0.0.1:3306/database’<br>export DATABASE_URI_TEST = ‘sqlite:///test_app.db’<br>export REDIS_CACHE_URI = ‘’<br>export AWS_ACCESS_KEY = ‘’<br>export AWS_SECRET_KEY = ‘’</em></span></pre><p id="30b7" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">Before moving into another related topics, I want to cycle back for a while on security aspects, the “12 Factor App” and the env vars.</p><p id="7381" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph=""><strong class="mu nv">a)</strong> <strong class="mu nv">Is secure to use env vars?</strong></p><p id="86cd" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">Saying sharply “yes” or “not”, without some supportive arguments, for me, could be erroneous. Let me elaborate a bit on this matter but, also let me start my argumentation with a clear statement: <strong class="mu nv">process environments are only accessible to the user that owns the process, and root, of course</strong>.</p><p id="d9e4" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph=""><strong class="mu nv">Environment variables are plenty secure</strong>. The question in itself is loosely related to the real concern behind using env vars, that is, <em class="ng">What happens if the system is compromised?</em> Well, in such case, with the system already compromised, the less of the problems is the use of env vars. In fact, that’s funny because even in such scenario, there’s a silly security benefit of using env vars over configuration files and, amazingly, it is obscurity. Meaning that, if someone has gained root access, (s)he can get to both, files and env vars, but env vars will be less apparent at glance.</p><p id="0d32" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">On a modern UNIX-like system, you can only access the data stored in an environment variable in 5 different situations, all of them with native controls:</p><p id="147a" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph=""><strong class="mu nv">1. The running environment of the process:</strong></p><p id="1bc1" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">When the process is running, the environment variables of that process can be accessed through /proc/$PID/environ. However, only the user who owns the process, or root, can access that file.</p><p id="26d1" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph=""><strong class="mu nv">2. The source of the environment variables:</strong></p><p id="1fc1" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">If you’re using an init script, and the variables are stored in that init script, the variables can of course be obtained by reading that script, or, if the env vars are coming from somewhere else, then wherever that is. Permissions on files here are the key factor to consider.</p><p id="1936" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph=""><strong class="mu nv">3. Executing the <em class="ng">‘ps’</em> command and reviewing the output:</strong></p><p id="1918" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">If the process is (badly) launched via something like…</p><pre class="lx ly lz ma mb kj iq dx"><span id="9630" class="nw gl dg bt nx b fo ny nz s oa" data-selectable-paragraph=""><em class="ng">sh -c ‘cd /foo/bar; POP=star /my/executable’</em></span></pre><p id="3085" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">…then that “<em class="ng">sh”</em> process will be visible in the “<em class="ng">ps”</em> command output. The portion of the above code in red is an env var assignment (badly) done in run-time.</p><p id="3126" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph=""><strong class="mu nv">4. During the “execve” system call:</strong></p><p id="e0f4" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">The “execve” system call does not directly leaks the environment. However, there is a generic audit mechanism that can log the arguments of every system call, including execve. So, if the UNIX system auditing is enabled, the environment can be sent through the audit mechanism and end up in a log file. On a decently configured system, only the root has this access, that means, data is sent to, i.e., to /var/log/audit/audit.log, that is only readable by root, and written by the auditd daemon, that is also running as root.</p><p id="142a" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph=""><strong class="mu nv">5. During a “ptrace” system call:</strong></p><p id="8e98" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">This system call allows a process to inspect the memory and even execute code in the context of another process. It’s what allows debuggers to exist. Only a specific UID can trace its own processes. Furthermore, if a process is privileged (setuid or setgid), only root can trace it.</p><p id="c373" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">So, as a succinct resume, one unprivileged user can’t observe env vars for another user through the process table (<em class="ng">“ps auxwwe” </em>command). If somebody is observing another user’s process, that is root. The commands that set environment variables (i.e., <em class="ng">export</em>) are shell builtins which don’t make it onto the process table and, by extension, aren’t in /proc/$pid/cmdline. Finally, /proc/$pid/environ is only readable by the UID of the process owner.</p><p id="a23d" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">Env vars are an essential part of an UNIX-like system. That doesn’t mean they must be used for everything, or they are best suited that any other technique. That wouldn’t be true. The problem with env vars is allowing anyone to modify environment variables of significance. And that doesn’t happen by weird hacking techniques, no, that happens by wrong programming actions. Programmers should always be cautious as to what data their programs accept and use for subsequent processing/directives.</p><h2 id="7244" class="gk gl dg bt bs di mi nh mk ni mm nj mo nk mq nl go"><strong class="bi">AN EXAMPLE “ECHO” MICROSERVICE IN PYTHON</strong></h2><p id="ff36" class="ms mt dg bt mu b mv mw mx my mz na nb nc nd ne nf" data-selectable-paragraph="">In order to demonstrate how a microservice can be quickly crafted in Python, we’re going to build an “echo” program. An echo program will be a simple microservice containing two namespaces:</p><ul><li id="cfce" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">One namespace acting as URL index, the well-known ‘/’.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">One namespace accepting POSTing in the “/echo” and /echo/&lt;value&gt; URLs.</li></ul><p id="0c76" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">The example code follows:</p><pre class="lx ly lz ma mb kj iq dx"><span id="f236" class="nw gl dg bt nx b fo ny nz s oa" data-selectable-paragraph=""><em class="ng">“”” Microservice main programm file “””<br>##<br>#<br># This file is the microservice itself.<br>#<br>##</em></span><span id="8a30" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><em class="ng"># pylint: disable=invalid-name; <br># In order to avoid false positives with Flask</em></span><span id="333c" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><em class="ng">from os import environ<br>from datetime import datetime<br>from flask import Flask, jsonify, make_response, url_for, request<br>import settings</em></span><span id="e1e9" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><em class="ng"># — Application initialization. — — — — — — — — — — — — — — — — — — — <br>__modeConfig__ = environ.get(‘MODE_CONFIG’) or ‘Development’<br>APP = Flask(__name__)<br>APP.config.from_object(getattr(settings, __modeConfig__.title()))</em></span><span id="7991" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><em class="ng"># — This functions control how to respond to common errors. — — —<br>@APP.errorhandler(404)<br>def not_found(error):<br>    “”” HTTP Error 404 Not Found “””<br>    headers = {}<br>    return make_response(<br>    jsonify({‘error’: ‘true’,‘msg’: str(error)}), 404, headers)</em></span><span id="bceb" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><em class="ng">@APP.errorhandler(405)<br>def not_allowed(error):<br>    “”” HTTP Error 405 Not Allowed “””<br>    headers = {}<br>    return make_response(jsonify({‘error’: ‘true’,‘msg’: str(error)}), 405, headers)</em></span><span id="89e4" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><em class="ng">@APP.errorhandler(500)<br>def internal_error(error):<br>    “”” HTTP Error 500 Internal Server Error “””<br>    headers = {}<br>    return make_response(jsonify({‘error’: ‘true’,‘msg’: str(error)}), 500, headers)</em></span><span id="45cb" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><em class="ng"># — This piece of code controls what happens during the whole <br># HTTP transaction.<br>@APP.before_request<br>def before_request():<br>    “”” This function handles HTTP requests arriving the API “””<br>    pass</em></span><span id="eda3" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><em class="ng">@APP.after_request<br>def after_request(response):<br>    “”” This function handles HTTP responses to client “””<br>    return response</em></span><span id="6b85" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><em class="ng"># — This is where the API effectively starts. — — — — — — — — — — —<br>@APP.route(‘/’, methods=[‘GET’])<br>def index():<br>    “””<br>    This is the API index endpoint with HATEOAS support<br>    :param: none<br>    :return: a JSON (application/json)<br>    “””<br>    headers = {}<br>    return make_response(jsonify({‘msg’: ‘this is index endpoint’,‘tstamp’: datetime.utcnow().timestamp(),‘endpoints’: {‘url_echo’: url_for(‘echo’, _external=True)}}), 200, headers)</em></span><span id="17f5" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><em class="ng">@APP.route(‘/echo’, methods=[‘POST’])<br>@APP.route(‘/echo/&lt;string:item&gt;’, methods=[‘POST’])<br>def echo(**kwargs):<br>    “””<br>    This is the ECHO endpoint with HATEOAS support<br>    :param **kwargs: gets an item from the url as a string of any size and format<br>    :return: a JSON (application/json)<br>    “””<br>    if kwargs:<br>        content = kwargs[‘item’]<br>    else:<br>        content = ‘none’<br>    <br>    if request.args.get(‘lang’, type=str) is None:<br>        lang = ‘none’<br>    else:<br>        lang = request.args.get(‘lang’, type=str)<br>        headers = {}<br>        return make_response(jsonify({‘msg’: ‘this is an echo endpoint’,‘tstamp’:datetime.utcnow().timestamp(),‘namespace_params’: {‘content_received’: content,‘language’: lang},‘endpoints’: {‘url_index’: url_for(‘index’, _external=True)}}), 200, headers)</em></span><span id="5b32" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><em class="ng"># — Finally, the application is run, more or less ;) — — — — — — —<br>if __name__ == ‘__main__’:<br>    APP.run()</em></span></pre><p id="e247" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">Now, let’s review the code to understand what happens in each block:</p><p data-selectable-paragraph=""><img src="https://miro.medium.com/max/750/1*FpioJvB6IT4tdwEIidzOeQ.png" data-is-external-image="true" alt="Python imports" width="375" height="59"></p>Python imports<p id="e452" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">The above statements are the main application imports. At the end of the block it’s imported the configuration file with the env vars that we have defined on separate files.</p><p data-selectable-paragraph=""><img src="https://miro.medium.com/max/752/1*_KXK6YNSJxcAm62qeJaRxQ.png" data-is-external-image="true" alt="Python application initialization from env vars" width="376" height="75"></p>Python application initialization from env vars<p id="b252" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">Later, the default configuration is effectively loaded. If it cannot be loaded, because the variable Is not defined or because the option in the variable is erroneous, then, a default value is configured. The default value for this microservice is “Development”. This option will act as a failsafe in our scenario, but, in other scenario other potential options can fit better, like Production or even not allowing the microservice execution without a proper configuration, which makes more sense.</p><p data-selectable-paragraph=""><img src="https://miro.medium.com/max/750/1*O-Yu4ipiW5epLU7R6BLFag.png" data-is-external-image="true" alt="Typical HTTP errors managed in APIs" width="375" height="556"></p>Typical HTTP errors managed in APIs<br><p id="da72" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">This block controls the typical HTTP errors that we can find while executing the microservice program. May sound silly, but, controlling this tree errors, we are basically controlling around 90% of the situations we can face with an API in production.</p><p id="eafc" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">Pay special attention to the first clause after the docstring, the one that says “<em class="ng">headers = {}</em>”. This clause allows to add more headers, if needed, to the default HTTP headers the web server is presenting to clients. You’ll see this in more detail a bit later.</p><p id="b482" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">The “<em class="ng">jsonify</em>” clause generates a JSON-formatted response based on the key-values “<em class="ng">error</em>” and “<em class="ng">msg</em>”. The JSON is sent back to the client.</p><p data-selectable-paragraph=""><img src="https://miro.medium.com/max/750/1*iI0gMjqwVLQENhZeX-xwPA.png" data-is-external-image="true" alt="Special functions controlling HTTP request/response transactions" width="375" height="131"></p>Special functions controlling HTTP request/response transactions<br><p id="274e" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">The “<em class="ng">before request</em>” and “<em class="ng">after request</em>” are one of the reasons why Flask is so powerful. These two predefined decorators in the micro-framework. In combination with a function, it allows to modify the HTTP request sent by the client to the server (“<em class="ng">before request</em>”) and the HTTP response originated by the API on-the-fly to the customer (“<em class="ng">after request</em>”). Typical uses for this include:</p><ul><li id="4f0c" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">Add headers for server-side purposes, like caching or proxying.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">Add personalized eTag.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">Open a database connection.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">Initialize the logging facility.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">Alter server response to adapt to client, i.e. to the User-Agent or View-Point.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">Adapt HTTP responses to clients in the interim periods.</li></ul><p><img src="https://miro.medium.com/max/750/1*WLa8jGoyGSweH14dnHXmfg.png" data-is-external-image="true" alt="An index namespace on a RESTful API" width="375" height="282"></p>An index namespace on a RESTful API<br><p id="206a" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">Finally, we get to the first piece of the microservice business logic in itself. This piece of code configures the response a client will receive when it’s called the index of the domain using an HTTP GET verb/method. This response is a JSON containing:</p><ul><li id="1d46" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">A text literal indicating where the client is exactly on this API</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">A timestamp (server-side time)</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">A list browsable namespaces and endpoints this API has available (HATEOAS)</li></ul><p><img src="https://miro.medium.com/max/752/1*X4DrnOBiSVz7c41ZoBZIqA.png" data-is-external-image="true" alt="Very basic handling of URL parameters received on a POST" width="376" height="343"></p>Very basic handling of URL parameters received on a POST<br><p id="d606" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">And this is the second piece of the microservice business logic. The URL endpoint is different. Before it was “<em class="ng">/</em>” (the domain index) whereas now the endpoint is named “<em class="ng">/echo</em>”. There’s an additional line that accepts any string literal after the “<em class="ng">/echo</em>” in the form “<em class="ng">/echo/&lt;string_literal&gt;</em>”. On both cases the HTTP verb/method in use is POST, so, we accept data sent from client reaching the API, but, not in any way.</p><p id="cb70" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">After the routing options:</p><ul><li id="9c3a" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">In (1), we control the arguments we are receiving from the client. Unauthenticated clients are always treated as non-trusted, so, anything coming from clients need to be quarantined. And this is exactly what we are doing with this statement. From the POST URI we load all the received POST from the client as a long string. That way, we disable potential errors while dealing with a SQLi or XSS, as we have converted the whole URI that can contain scriptable code on a text literal. Moreover, we can quickly limit the length of the string and filter the presence of unwanted special characters, source of the problem on SQL and XSS.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">In (2), we run along the POST URI looking for fixed parameters, like the language clause. We can be receiving a SQLi or an XSS but we won’t pay attention to those pieces of the POST URI, only to the elements we want to pick. If we identify them, they are captured and again converted into strings on new variables. The rest is garbage.</li></ul><p id="c248" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">In this occasion, the response sent back to the client after his/her post is another JSON, this time containing:</p><ul><li id="23ca" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">A text literal indicating where the client is exactly on this API</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">A timestamp (server-side time)</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">The string literals to be echoed</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">A list browsable namespaces and endpoints this API has available (HATEOAS)</li></ul><p id="b18c" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">Finally, the application is run if the file containing the program is the main program file, and not a file included (called) by another program:</p><p data-selectable-paragraph=""><img src="https://miro.medium.com/max/748/1*gZdSlCIC15WGuniZzA6R4w.png" data-is-external-image="true" alt="Main program execution" width="374" height="74"></p>Main program execution<br><p id="a733" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">Most of the “echo” microservice lines of code are boilerplate, but, they were included in order to document the code and demonstrate good programming skills. Programmer skills, as well as code, can be tested, in fact should always be tested, and about testing is the next section.</p><h2 id="42e2" class="gk gl dg bt bs di mi nh mk ni mm nj mo nk mq nl go"><strong class="bi">TESTING AND ANALYSING THE CODE</strong></h2><p id="ea40" class="ms mt dg bt mu b mv mw mx my mz na nb nc nd ne nf" data-selectable-paragraph="">I’m mentioning here the words “testing” and “analysing” because, for me, both terms have slightly different meanings:</p><p id="fef6" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph=""><strong class="mu nv">Testing (the code)</strong> for me means an intrinsic development sub-process, that can take place before or after the business logic is created as code. This will depend on the type of programming paradigm being followed, i.e., Waterfall, Extreme, Agile, Lean, DDD, BDD, TDD, ATDD, etc…</p><p id="aecd" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">In the DevSecOps model, the model we are following in the cloud industrialization sub-programme of the cloud programme that is in course, DevSecOps is about DEVelopment, SECurity, OPerationS <strong class="mu nv">and QA, of course</strong>. The fact the letters Q &amp; A aren’t in the title doesn’t affect the fact <strong class="mu nv">QA is essential to DevSecOps. QA is an enable</strong>r.</p><p id="931d" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">In DevSecOps, QA is about trying to push tests with automation into the continuous integration systems. Tests must have zero human intervention and should generate their own test data. QA also works with operations on establishing monitoring tools and, perhaps, on continuously running chaos monkey tests in production to ensure a high level of maturity is achieved.</p><p id="d8be" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph=""><strong class="mu nv">Analysing (the code)</strong> for me means an additional security layer on the way the code, and the tests, are built in order to ensure that code, holding the business logic and the testing process, is secure enough.</p><p id="eac5" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">Source code analysis can be either static or dynamic. In static analysis, debugging is done by examining the code without actually executing the program. This can reveal errors at an early stage in program development, often eliminating the need for multiple revisions later. After static analysis has been done, dynamic analysis is performed in an effort to uncover more subtle defects or vulnerabilities. Dynamic analysis consists more of real-time program testing.</p><pre class="lx ly lz ma mb kj iq dx"><span id="c318" class="nw gl dg bt nx b fo ny nz s oa" data-selectable-paragraph=""><strong class="nx nv"><em class="ng">NOTE</em></strong><em class="ng">: The most appropriate on a working environment is to perform both static and dynamic code analysis. While static code analysis is dead simple to achieve, the dynamic code analysis might require several external tooling, so, this part of the analysis won’t be documented extensively.</em></span></pre><p id="d6ab" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">In Python, and with any micro-framework, testing stage is relatively simple. I won’t discuss here and now the fact of which development process/paradigm is best or when do tests need to be written. Of course, I’m a human and I have a preference but my preference is just an opinion. My preference is following BDD, thus, writing meaningful tests before writing the code, so, when you start coding the business logic, you get more concentrated on building what you specifically need to build.</p><p id="ad4d" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">With all this introduction already set, I’ll start by approaching the nature of testing stage and later we’ll address the nature of the code analysis stage.</p><p id="18ff" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph=""><strong class="mu nv">a)</strong> <strong class="mu nv">Testing code with Python tools</strong></p><p id="bccc" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">Python provides all means for code testing. I’m not going to enter in very profound details, but it’s possible to perform all types of testing with a single unified or few distributed set of tools. All of the Open source tools, all of them, are detailed on <a href="https://wiki.python.org/moin/PythonTestingToolsTaxonomy" class="bc co nr ns nt nu">https://wiki.python.org/moin/PythonTestingToolsTaxonomy</a>. In order to selected a tool, you have to have clear what’s what you try to test:</p><ul><li id="038a" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf ot ou ov" data-selectable-paragraph=""><strong class="mu nv">Unit test</strong>: Typically, “mock” or “dummy” implementations. Specify and test one point of the contract of single method of a class. This should have a very narrow and well-defined scope. Complex dependencies and interactions to the outside world are stubbed or mocked.</li><li id="121c" class="ms mt dg bt mu b mv ow mx ox mz oy nb oz nd pa nf ot ou ov" data-selectable-paragraph=""><strong class="mu nv">Integration test</strong>: Test the correct inter-operation of multiple subsystems. There is whole spectrum there, from testing integration between two classes, to testing integration with the production environment.</li><li id="494c" class="ms mt dg bt mu b mv ow mx ox mz oy nb oz nd pa nf ot ou ov" data-selectable-paragraph=""><strong class="mu nv">Smoke test (aka Sanity check)</strong>: A simple integration test where we just check that when the system under test is invoked it returns normally and does not blow up suddenly:</li><li id="dc3f" class="ms mt dg bt mu b mv ow mx ox mz oy nb oz nd pa nf ot ou ov" data-selectable-paragraph="">Smoke testing is both an analogy with electronics, where the first test occurs when powering up a circuit. if it smokes, of course, it’s bad :) …</li><li id="a7f3" class="ms mt dg bt mu b mv ow mx ox mz oy nb oz nd pa nf ot ou ov" data-selectable-paragraph="">… and, apparently, with plumbing, where a system of pipes is literally filled by smoke and then checked visually. If anything smokes, the system is leaky, which is also bad :)</li><li id="7744" class="ms mt dg bt mu b mv ow mx ox mz oy nb oz nd pa nf ot ou ov" data-selectable-paragraph=""><strong class="mu nv">Regression test</strong>: A test that was written when a bug was fixed. It ensures that this specific bug will not occur again. The full name is “non-regression test”. It can also be a test made prior to changing an application to make sure the application provides the same outcome.</li></ul><p id="d8c7" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">To the above, I will add:</p><ul><li id="e9ad" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf ot ou ov" data-selectable-paragraph=""><strong class="mu nv">Acceptance test</strong>: Test that a feature or use case is correctly implemented. It is similar to an integration test, but with a focus on the use case to provide rather than on the components involved.</li><li id="8853" class="ms mt dg bt mu b mv ow mx ox mz oy nb oz nd pa nf ot ou ov" data-selectable-paragraph=""><strong class="mu nv">System test</strong>: Tests a system as a black box. Dependencies on other systems are often mocked or stubbed during the test, otherwise, it would be more of an integration test.</li><li id="05a7" class="ms mt dg bt mu b mv ow mx ox mz oy nb oz nd pa nf ot ou ov" data-selectable-paragraph=""><strong class="mu nv">Pre-flight check</strong>: Tests that are repeated in a production-like environment, to alleviate the <em class="ng">“it builds/it works on my machine”</em>syndrome, by the way, a syndrome that will entirely disappear with containerization.</li><li id="0069" class="ms mt dg bt mu b mv ow mx ox mz oy nb oz nd pa nf ot ou ov" data-selectable-paragraph=""><strong class="mu nv">Canary test:</strong> Test that is automated, non-destructive and that is <strong class="mu nv">run on a regular basis</strong> in a <strong class="mu nv">live</strong> environment, such that if it ever fails, something really bad has happened in reality.</li></ul><p id="6c16" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">So, to resume, the toolbox that Python can provide for testing is huge and well-detailed. In a sake for a better understanding, I will stick my examples to <strong class="mu nv">Pytest</strong> in order to exemplify unit testing and test-runs .</p><p id="4df1" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph=""><strong class="mu nv">b)</strong> <strong class="mu nv">Analysing code with Python tools</strong></p><p id="4891" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">Python is an awesome programming language that includes support for almost everything you can image, even linter tools. A <strong class="mu nv">linter</strong> or <strong class="mu nv">lint</strong> refers to tools that analyze source code to flag programming errors, bugs, stylistic errors, and suspicious constructs. The term originates from a UNIX utility that examined C language source code. Lint-like tools generally perform static analysis of source code.</p><p id="c92c" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">Specifically, in Python, you can use several lint tools, because they all complement each other nicely:</p><ul><li id="6c42" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf ot ou ov" data-selectable-paragraph=""><strong class="mu nv">pycodestyle </strong>(before pep8)<strong class="mu nv">:</strong> for checking the style.</li><li id="3dee" class="ms mt dg bt mu b mv ow mx ox mz oy nb oz nd pa nf ot ou ov" data-selectable-paragraph=""><strong class="mu nv">pyflakes:</strong> for fast static analysis.</li><li id="c3b1" class="ms mt dg bt mu b mv ow mx ox mz oy nb oz nd pa nf ot ou ov" data-selectable-paragraph=""><strong class="mu nv">mccabe:</strong> to find code that is too complex and needs refactoring.</li><li id="2bce" class="ms mt dg bt mu b mv ow mx ox mz oy nb oz nd pa nf ot ou ov" data-selectable-paragraph=""><strong class="mu nv">pylint:</strong> for everything.</li></ul><p id="5e62" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">As this article is about demonstrating a DevSecOps pipeline can be followed with simplicity, I will concentrate in the use of <strong class="mu nv">Pylint</strong> for the static code analysis.</p><p id="fe20" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph=""><strong class="mu nv">c)</strong> <strong class="mu nv">Tests in execution: PYTEST</strong></p><p id="ba89" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">Rather than a tool, Pytest is a framework that makes it easy to write small tests, yet scales to support complex functional testing for applications and libraries. The best part is, the overhead for creating unit tests is close to zero.</p><p id="ee84" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">Pytest makes use of Python’s “assert” statement to compute assertions. Assertions are a systematic way to check that the internal state of a program is as the programmer expected, with the goal of catching bugs. In particular, they’re good for catching false assumptions that were made while writing the code, or abuse of an interface by another programmer. In addition, they can act as in-line documentation to some extent, by making the programmer’s assumptions obvious.</p><p id="3552" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">A simple Pytest check can be as simple as this:</p><pre class="lx ly lz ma mb kj iq dx"><span id="6f94" class="nw gl dg bt nx b fo ny nz s oa" data-selectable-paragraph=""><em class="ng">import unittest<br>from unnecessary_math import multiply</em></span><span id="47eb" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><em class="ng">def test_numbers_3_4():<br>    assert(multiply(3,4) == 12)</em></span></pre><p id="4d7a" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">Pytest works having a test folder in your project. Inside this folder, Pytest will look for Python files with the following conventions:</p><ul><li id="5a2d" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">Files should be named “<em class="ng">test_&lt;function&gt;.py</em>”, being <em class="ng">&lt;function&gt;</em> the name of the python function that you want to (unit) test.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">The unit test inside the test file should be named “<em class="ng">test_&lt;type_of_data&gt;_&lt;function&gt;.py”</em>, being <em class="ng">&lt;type_of_data&gt;</em> the data type and <em class="ng">&lt;function&gt;</em> the name of the function to test.</li></ul><p id="ac2b" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">In the tests folder of the “echo” microservice I’ve included a couple of dumb/dummy tests to document the testing process with Pytest.</p><p id="8a96" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph=""><strong class="mu nv">== test_index.py ==</strong></p><pre class="lx ly lz ma mb kj iq dx"><span id="4e7f" class="nw gl dg bt nx b fo ny nz s oa" data-selectable-paragraph=""><em class="ng">“””<br>This is a test file for pytest<br>“””<br>import pytest<br>from flask import Flask, request<br> <br>TESTAPP = Flask(__name__)<br> <br>@pytest.fixture<br>def test_client():<br>    “”” This sets testing mode “””<br>    TESTAPP.config[‘TESTING’] = True</em></span><span id="fe63" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><em class="ng">def test_string_index():<br>    “”” This will test the echo endpoint for a specific behavior”””<br>    with TESTAPP.test_request_context(‘/’):<br>        assert request.path == ‘/’</em></span></pre><p id="8b2c" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph=""><strong class="mu nv">== test_echo.py ==</strong></p><pre class="lx ly lz ma mb kj iq dx"><span id="436a" class="nw gl dg bt nx b fo ny nz s oa" data-selectable-paragraph=""><em class="ng">“””<br>This is a test file for pytest<br>“””<br>import pytest<br>from flask import Flask, request<br> <br>TESTAPP = Flask(__name__)<br> <br>@pytest.fixture<br>def test_client():<br>    “”” This sets testing mode “””<br>    TESTAPP.config[‘TESTING’] = True<br> <br>def test_string_echo():<br>    “”” This will test the echo endpoint for a specific behavior”””<br>    with TESTAPP.test_request_context(‘/echo/1’):<br>    assert request.path == ‘/echo/1’</em></span></pre><p id="aadb" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">Running Pytest on the above pieces of code will result in something like this:</p><pre class="lx ly lz ma mb kj iq dx"><span id="e33b" class="nw gl dg bt nx b fo ny nz s oa" data-selectable-paragraph=""><em class="ng">(venv) jon@Laptop ~/DevOps/PythonAPIContainers $ </em><strong class="nx nv"><em class="ng">pytest -vv — disable-warnings</em></strong><em class="ng">ç<br>============= test session starts =============<br>platform darwin — Python 3.7.0, pytest-3.8.1, py-1.6.0, pluggy-0.7.1 –<br>/Library/Frameworks/Python.framework/Versions/3.7/bin/python3.7<br>cachedir: .pytest_cache<br>rootdir: /Users/jon/Documents/DevOps/Github/PythonAPIContainers, inifile:</em></span><span id="28cf" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><em class="ng">collected 2 items<br>tests/test_echo.py::test_string_echo </em><strong class="nx nv"><em class="ng">PASSED</em></strong><em class="ng"> [ 50%]<br>tests/test_index.py::test_string_index </em><strong class="nx nv"><em class="ng">PASSED</em></strong><em class="ng"> [100%]</em></span><span id="7f07" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><em class="ng">========= 2 passed, 3 warnings in 0.31 seconds =========</em></span></pre><p id="c6a0" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">Notice the two lines in green where Pytest confirms the files in the “tests” folder have been executed and the result has been satisfactory.</p><p id="78b0" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">In case the executed tests would fail, the resume would be showing a complete python stack trace with the programming issues found and a final message saying “0 tests passed”.</p><p id="30a9" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph=""><strong class="mu nv">a)</strong> <strong class="mu nv">Tests in execution: PYLINT</strong></p><p id="6e28" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">Pylint’s range of features, and the fact that it is highly active and maintained and can be easily automated (with Apycot, Hudson, Travis or Jenkins), make it the absolute must have tool for the job. It supports a number of features, from coding standards to error detection, and it also helps with refactoring by detecting duplicated code.</p><p id="88fb" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">Pylint is overly pedantic out of the box and benefits from a minimal effort of configuration, but it is fully customizable through a <em class="ng">pylintrc</em> file where you select which errors or conventions are relevant/irrelevant to you. Nonetheless, most messages sent out by the tool will be self-explanatory.</p><p id="eb23" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">If we slightly alter the content of the “echo” app.py microservice included in this article before, and perform some alterations on the file to force to have irregularities yet leaving it operational from programming perspective, we can see how Pylint works:</p><pre class="lx ly lz ma mb kj iq dx"><span id="5b3e" class="nw gl dg bt nx b fo ny nz s oa" data-selectable-paragraph=""><strong class="nx nv"><em class="ng">(venv) jon@Laptop ~/DevOps/PythonAPIContainers $ pylint app.py<br>************* Module app<br></em></strong><em class="ng">app.py:135:0: C0304: Final newline missing (missing-final-newline)<br>app.py:28:0: C0111: Missing function docstring (missing-docstring)<br>app.py:41:0: C0111: Missing function docstring (missing-docstring)<br>app.py:54:0: C0111: Missing function docstring (missing-docstring)<br>app.py:69:0: C0111: Missing function docstring (missing-docstring)<br>app.py:74:0: C0111: Missing function docstring (missing-docstring)<br>app.py:81:0: C0111: Missing function docstring (missing-docstring)<br>app.py:100:0: C0111: Missing function docstring (missing-docstring)<br>app.py:12:0: C0411: standard import “from os import environ” should be placed before “import settings” (wrong-import-order)<br>app.py:13:0: C0411: standard import “from datetime import datetime” should be placed before “import settings” (wrong-import-order)<br>app.py:14:0: C0411: third party import “from flask import Flask, jsonify, make_response, url_for, request” should be placed before “import settings” (wrong-import-order)<br> — — — — — — — — — — — — — — — — — -<br></em><strong class="nx nv"><em class="ng">Your code has been rated at 6.76/10</em></strong></span></pre><p id="1b81" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">The results of Pylint can be interpreted this way:</p><ul><li id="1430" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">First section, in maroon color, as the text between brackets indicates, a final blank line needs to be added to the file.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">Second section, in purple color, indicates that the docstring is missing for several functions. A docstring is the string literal specified in source code that is used, like a comment, to document a specific segment of code.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">Third section, in blue color, indicates the source code is unordered and requires tidiness.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">Finally, at the end of the report, in color red, source code is rated on a scale from 0 to 10. This an important value for the developer to check how complaint (s)he is against the PEPs (Python Enhancement Proposals)</li></ul><p id="64b1" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">When the code is corrected, Pylint asserts:</p><pre class="lx ly lz ma mb kj iq dx"><span id="35d2" class="nw gl dg bt nx b fo ny nz s oa" data-selectable-paragraph=""><strong class="nx nv"><em class="ng">Your code has been rated at 10.00/10 (previous run: 6.76/10, +3.24)</em></strong></span></pre><p id="bc0d" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">On a DevSecOps (and QA) pipeline that means automation of tests (static code analysis) can be fairly simple to address, by not just mentioning the fact the developer should always be interested in coding correctly.</p><h2 id="7ab0" class="gk gl dg bt bs di mi nh mk ni mm nj mo nk mq nl go"><strong class="bi">DOCKERFILE: THE CONTAINERIZATIN PROCCESS</strong></h2><p id="5458" class="ms mt dg bt mu b mv mw mx my mz na nb nc nd ne nf" data-selectable-paragraph="">A <strong class="mu nv">Dockerfile</strong> is a text document that contains all the commands a user could call on the command line to assemble a container image. Using docker-build users can create an automated build that executes several command-line instructions in succession.</p><p id="0538" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">An example Dockerfile follows:</p><pre class="lx ly lz ma mb kj iq dx"><span id="b74f" class="nw gl dg bt nx b fo ny nz s oa" data-selectable-paragraph=""><em class="ng">FROM alpine:3.8<br>MAINTAINER Jonathan Gonzalez &lt;j@0x30.io&gt; @EA1HET<br> <br> RUN apk add — no-cache python3 \<br> &amp;&amp; python3 -m ensurepip \<br> &amp;&amp; pip3 install -U pip \<br> &amp;&amp; rm -rf /usr/lib/python*/ensurepip \<br> &amp;&amp; rm -rf /root/.cache \<br> &amp;&amp; rm -rf /var/cache/apk/* \<br> &amp;&amp; find / \<br> \( -type d -a -name test -o -name tests \) \<br> -o \( -type f -a -name ‘*.pyc’ -o -name ‘*.pyo’ \) \<br> -exec rm -rf ‘{}’ + \<br> &amp;&amp; mkdir /app<br> <br>EXPOSE 5000<br>WORKDIR /app<br>COPY . /app<br>RUN pip install --no-cache-dir -r requirements.txt<br>ENTRYPOINT /app/boot.sh</em></span></pre><p id="c30c" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">The Dockerfile used for the containerization of the “echo” microservice is the one above, but, How it works?</p><ul><li id="ca47" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">The first line, in red, defines what is the base content the container uses in order to get built. A base can be a set or libraries or a micro-operating system. In the present case, a micro BusyBox-based system is used to run the Python microservice.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">The second block, in orange, defines the different actions on packages required to prepare the micro BusyBox-based system for running the current version of Python and the microservice written in Python.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">The next line, in violet, indicates which TCP port will be used to expose IP communications from the container to the container orchestrator.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">Finally, in green, code is copied from the developer computer to the container image. All the files will be placed in the container image as if it were the on de developer computer, so, if something works on the developer computer, it will work on the container image. A final sentence is included describing which executable file needs to be run when the container image is loaded in memory by the container orchestrator.</li></ul><p id="8874" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">Now that a Dockerfile is ready, we just need to issue the different commands required to assembre the container image. They are</p><h2 id="5544" class="nw gl dg bt bs di pb pc pd pe pf pg ph pi pj pk pl" data-selectable-paragraph="">BUILD A CONTAINER IMAGE</h2><pre class="lx ly lz ma mb kj iq dx"><span id="7a06" class="nw gl dg bt nx b fo ny nz s oa" data-selectable-paragraph=""><em class="ng">docker build . -t my_api:v1</em></span></pre><p id="95dc" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">where:</p><ul><li id="d3d8" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">“.” represents the current directory where you are.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">“-t” means you want to tag your container image with a compound name.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">“my_api” is the name of the container image.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">“v1” is the part of the tag name related to the container version.</li></ul><h2 id="f4e2" class="nw gl dg bt bs di pb pc pd pe pf pg ph pi pj pk pl" data-selectable-paragraph="">RUN A CONTAINER IMAGE</h2><pre class="lx ly lz ma mb kj iq dx"><span id="1d08" class="nw gl dg bt nx b fo ny nz s oa" data-selectable-paragraph=""><em class="ng">docker run -p 5000:5000 my_api:v1 -it api_container</em></span></pre><p id="06a9" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">where:</p><ul><li id="130a" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">“-p 5000:5000” is the TCP port mapped internally and externally to a container.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">“my_api:v1” is the local image you want to run as a container.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">“-it” runs interactively providing a more readable name to this container in order to clearly identify it when issuing a <em class="ng">“docker ps”</em> command.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">“api_container” is the name you want to assign to this container image when it is run.</li></ul><h2 id="03c8" class="nw gl dg bt bs di pb pc pd pe pf pg ph pi pj pk pl" data-selectable-paragraph="">EXECUTE A SHELL INSIDE THE DOCKER CONTAINER (IF ANY)</h2><pre class="lx ly lz ma mb kj iq dx"><span id="7944" class="nw gl dg bt nx b fo ny nz s oa" data-selectable-paragraph=""><em class="ng">docker exec -it &lt;container_id&gt; ash</em></span></pre><p id="8ffa" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">where:</p><ul><li id="263e" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">“exec” indicates the intention to run a command associated to a container.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">“-it &lt;container_id&gt; means the command to execute will be executed in interactive format. A container ID (that can be retrieved issuing a “docker ps” needs to be detailed.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">“ash” is the name of an Alpine Linux shell.</li></ul><p id="e7cd" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">Finally, in order to publish a container in a container registry, a few more commands need to be executed on a sequence. They are:</p><pre class="lx ly lz ma mb kj iq dx"><span id="47ff" class="nw gl dg bt nx b fo ny nz s oa" data-selectable-paragraph=""><em class="ng">export DOCKER_ID_USER=”username”</em><em class="ng"><br>docker login<br>docker tag my_api:v1 $DOCKER_ID_USER/my_api:v1<br>docker push $DOCKER_ID_USER/my_api:v1</em></span></pre><ol><li id="f97b" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">An env var is defined with the Id of the Docker Registry user that will register the container in the repository.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">Next command will perform a login negotiation with the Docker Registry and will validate the user.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">If not done before, the container image will be properly tagged before being uploaded to the Docker Registry.</li><li class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf">Finally, the Docker image is pushed to the Docker Registry with the naming convention defined before.</li></ol><p id="0232" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">A log on the above actions is next:</p><pre class="lx ly lz ma mb kj iq dx"><span id="5493" class="nw gl dg bt nx b fo ny nz s oa" data-selectable-paragraph=""><strong class="nx nv"><em class="ng">jon@MiniHET ~/Documents/DevOps/Github/PythonAPIContainers $ docker build . -t my_api:v1<br></em></strong><em class="ng">Sending build context to Docker daemon  50.18kB<br>Step 1/8 : FROM alpine:3.8<br>3.8: Pulling from library/alpine<br>4fe2ade4980c: Pull complete<br>Digest: sha256:621c2f39f8133acb8e64023a94dbdf0d5ca81896102b9e57c0dc184cadaf5528<br>Status: Downloaded newer image for alpine:3.8<br>---&gt; 196d12cf6ab1<br>Step 2/8 : MAINTAINER Jonathan Gonzalez &lt;j@0x30.io&gt; @EA1HET<br>---&gt; Running in 9e3607810efb<br>Removing intermediate container 9e3607810efb<br>---&gt; 85c02539f662<br>Step 3/8 : RUN apk add --no-cache python3                                      &amp;&amp; python3 -m ensurepip                                         &amp;&amp; pip3 install -U pip                                          &amp;&amp; rm -rf /usr/lib/python*/ensurepip                            &amp;&amp; rm -rf /root/.cache                                          &amp;&amp; rm -rf /var/cache/apk/*                                      &amp;&amp; find /                                                           \( -type d -a -name test -o -name tests \)                      -o \( -type f -a -name '*.pyc' -o -name '*.pyo' \)              -exec rm -rf '{}' +                                         &amp;&amp; mkdir /app<br>---&gt; Running in ef7cb26a0cf9<br>fetch </em><a href="http://dl-cdn.alpinelinux.org/alpine/v3.8/main/x86_64/APKINDEX.tar.gz" class="bc co nr ns nt nu"><em class="ng">http://dl-cdn.alpinelinux.org/alpine/v3.8/main/x86_64/APKINDEX.tar.gz</em></a><em class="ng"><br>fetch </em><a href="http://dl-cdn.alpinelinux.org/alpine/v3.8/community/x86_64/APKINDEX.tar.gz" class="bc co nr ns nt nu"><em class="ng">http://dl-cdn.alpinelinux.org/alpine/v3.8/community/x86_64/APKINDEX.tar.gz</em></a><em class="ng"><br>(1/11) Installing libbz2 (1.0.6-r6)<br>(2/11) Installing expat (2.2.5-r0)<br>(3/11) Installing libffi (3.2.1-r4)<br>(4/11) Installing gdbm (1.13-r1)<br>(5/11) Installing xz-libs (5.2.4-r0)<br>(6/11) Installing ncurses-terminfo-base (6.1_p20180818-r1)<br>(7/11) Installing ncurses-terminfo (6.1_p20180818-r1)<br>(8/11) Installing ncurses-libs (6.1_p20180818-r1)<br>(9/11) Installing readline (7.0.003-r0)(10/11) Installing sqlite-libs (3.24.0-r0)<br>(11/11) Installing python3 (3.6.6-r0)<br>Executing busybox-1.28.4-r1.trigger<br>OK: 67 MiB in 24 packages<br>Looking in links: /tmp/tmpngqpumos<br>Requirement already satisfied: setuptools in /usr/lib/python3.6/site-packages (39.0.1)<br>Requirement already satisfied: pip in /usr/lib/python3.6/site-packages (10.0.1)<br>Collecting pip<br>Downloading https://files.pythonhosted.org/packages/5f/25/e52d3f31441505a5f3af41213346e5b6c221c9e086a166f3703d2ddaf940/pip-18.0-py2.py3-none-any.whl (1.3MB)<br>Installing collected packages: pip<br>Found existing installation: pip 10.0.1<br>Uninstalling pip-10.0.1:<br>Successfully uninstalled pip-10.0.1<br>Successfully installed pip-18.0<br>Removing intermediate container ef7cb26a0cf9<br>---&gt; e578960ef329<br>Step 4/8 : EXPOSE 5000<br>---&gt; Running in 533208720ceb<br>Removing intermediate container 533208720ceb<br>---&gt; 889a718aae42<br>Step 5/8 : WORKDIR /app<br>---&gt; Running in 2ab712110618<br>Removing intermediate container 2ab712110618<br>---&gt; b6fe8d313419<br>Step 6/8 : COPY . /app<br>---&gt; 7eb793bbe089<br>Step 7/8 : RUN pip install --no-cache-dir -r requirements.txt<br>---&gt; Running in ae95eb68de95<br>Collecting aniso8601==3.0.2 (from -r requirements.txt (line 1))<br>Downloading </em><a href="https://files.pythonhosted.org/packages/17/13/eecdcc638c0ea3b105ebb62ff4e76914a744ef1b6f308651dbed368c6c01/aniso8601-3.0.2-py2.py3-none-any.whl" class="bc co nr ns nt nu"><em class="ng">https://files.pythonhosted.org/packages/17/13/eecdcc638c0ea3b105ebb62ff4e76914a744ef1b6f308651dbed368c6c01/aniso8601-3.0.2-py2.py3-none-any.whl</em></a><em class="ng"><br>Collecting click==6.7 (from -r requirements.txt (line 2))<br>Downloading https://files.pythonhosted.org/packages/34/c1/8806f99713ddb993c5366c362b2f908f18269f8d792aff1abfd700775a77/click-6.7-py2.py3-none-any.whl (71kB)<br>Collecting environs==4.0.0 (from -r requirements.txt (line 3))<br>Downloading </em><a href="https://files.pythonhosted.org/packages/64/19/c1b8df73d2b2e4c704e65e1ec1423714f10cf2bf5489e7dac724eda62218/environs-4.0.0-py2.py3-none-any.whl" class="bc co nr ns nt nu"><em class="ng">https://files.pythonhosted.org/packages/64/19/c1b8df73d2b2e4c704e65e1ec1423714f10cf2bf5489e7dac724eda62218/environs-4.0.0-py2.py3-none-any.whl</em></a><em class="ng"><br>Collecting Flask==1.0.2 (from -r requirements.txt (line 4))<br>Downloading https://files.pythonhosted.org/packages/7f/e7/08578774ed4536d3242b14dacb4696386634607af824ea997202cd0edb4b/Flask-1.0.2-py2.py3-none-any.whl (91kB)<br>Collecting gunicorn==19.9.0 (from -r requirements.txt (line 5))<br>Downloading https://files.pythonhosted.org/packages/8c/da/b8dd8deb741bff556db53902d4706774c8e1e67265f69528c14c003644e6/gunicorn-19.9.0-py2.py3-none-any.whl (112kB)<br>Collecting itsdangerous==0.24 (from -r requirements.txt (line 6))<br>Downloading https://files.pythonhosted.org/packages/dc/b4/a60bcdba945c00f6d608d8975131ab3f25b22f2bcfe1dab221165194b2d4/itsdangerous-0.24.tar.gz (46kB)<br>Collecting Jinja2==2.10 (from -r requirements.txt (line 7))<br>Downloading https://files.pythonhosted.org/packages/7f/ff/ae64bacdfc95f27a016a7bed8e8686763ba4d277a78ca76f32659220a731/Jinja2-2.10-py2.py3-none-any.whl (126kB)<br>Collecting MarkupSafe==1.0 (from -r requirements.txt (line 8))<br>Downloading </em><a href="https://files.pythonhosted.org/packages/4d/de/32d741db316d8fdb7680822dd37001ef7a448255de9699ab4bfcbdf4172b/MarkupSafe-1.0.tar.gz" class="bc co nr ns nt nu"><em class="ng">https://files.pythonhosted.org/packages/4d/de/32d741db316d8fdb7680822dd37001ef7a448255de9699ab4bfcbdf4172b/MarkupSafe-1.0.tar.gz</em></a><em class="ng"><br>Collecting marshmallow==2.15.6 (from -r requirements.txt (line 9))<br>Downloading https://files.pythonhosted.org/packages/3f/4d/cb555dfc2e2f926179884665fa1e6ae6b8f8102e4f8228b73e2a30eb0ee0/marshmallow-2.15.6-py2.py3-none-any.whl (44kB)<br>Collecting python-dotenv==0.9.1 (from -r requirements.txt (line 10))<br>Downloading </em><a href="https://files.pythonhosted.org/packages/24/3d/977140bd94bfb160f98a5c02fdfbb72325130f12a325cf993182956e9d0e/python_dotenv-0.9.1-py2.py3-none-any.whl" class="bc co nr ns nt nu"><em class="ng">https://files.pythonhosted.org/packages/24/3d/977140bd94bfb160f98a5c02fdfbb72325130f12a325cf993182956e9d0e/python_dotenv-0.9.1-py2.py3-none-any.whl</em></a><em class="ng"><br>Collecting pytz==2018.5 (from -r requirements.txt (line 11))<br>Downloading https://files.pythonhosted.org/packages/30/4e/27c34b62430286c6d59177a0842ed90dc789ce5d1ed740887653b898779a/pytz-2018.5-py2.py3-none-any.whl (510kB)<br>Collecting Werkzeug==0.14.1 (from -r requirements.txt (line 12))<br>Downloading https://files.pythonhosted.org/packages/20/c4/12e3e56473e52375aa29c4764e70d1b8f3efa6682bef8d0aae04fe335243/Werkzeug-0.14.1-py2.py3-none-any.whl (322kB)<br>Installing collected packages: aniso8601, click, python-dotenv, marshmallow, environs, itsdangerous, Werkzeug, MarkupSafe, Jinja2, Flask, gunicorn, pytz<br>Running setup.py install for itsdangerous: started<br>Running setup.py install for itsdangerous: finished with status 'done'<br>Running setup.py install for MarkupSafe: started<br>Running setup.py install for MarkupSafe: finished with status 'done'<br>Successfully installed Flask-1.0.2 Jinja2-2.10 MarkupSafe-1.0 Werkzeug-0.14.1 aniso8601-3.0.2 click-6.7 environs-4.0.0 gunicorn-19.9.0 itsdangerous-0.24 marshmallow-2.15.6 python-dotenv-0.9.1 pytz-2018.5<br>Removing intermediate container ae95eb68de95<br>---&gt; 4e18577c050b<br>Step 8/8 : ENTRYPOINT /app/boot.sh<br>---&gt; Running in 9006f33efa75<br>Removing intermediate container 9006f33efa75<br>---&gt; 59ad5a3902a3<br></em><strong class="nx nv"><em class="ng">Successfully built 59ad5a3902a3<br>Successfully tagged my_api:v1</em></strong></span><span id="a835" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><strong class="nx nv"><em class="ng">jon@MiniHET ~/Documents/DevOps/Github/PythonAPIContainers $ docker image ls<br></em></strong><em class="ng">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE<br></em><strong class="nx nv"><em class="ng">my_api              v1                  59ad5a3902a3        6 seconds ago       43.2MB<br></em></strong><em class="ng">alpine              3.8                 196d12cf6ab1        13 days ago         4.41MB</em></span><span id="7f71" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><em class="ng">jon@MiniHET ~/Documents/DevOps/Github/PythonAPIContainers $<br>jon@MiniHET ~/Documents/DevOps/Github/PythonAPIContainers $<br></em><strong class="nx nv"><em class="ng">jon@MiniHET ~/Documents/DevOps/Github/PythonAPIContainers $ export DOCKER_ID_USER="ea1het"<br>jon@MiniHET ~/Documents/DevOps/Github/PythonAPIContainers $ docker login</em></strong></span><span id="985e" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><em class="ng">Authenticating with existing credentials...<br>Login Succeeded</em></span><span id="c04d" class="nw gl dg bt nx b fo ob oc od oe of nz s oa" data-selectable-paragraph=""><strong class="nx nv"><em class="ng">jon@MiniHET ~/Documents/DevOps/Github/PythonAPIContainers $ docker tag my_api:v1 $DOCKER_ID_USER/my_api:v1<br>jon@MiniHET ~/Documents/DevOps/Github/PythonAPIContainers $ docker push $DOCKER_ID_USER/my_api:v1<br>The push refers to repository [docker.io/ea1het/my_api]<br>578236ec6f44: Pushed<br>f4bab11cc8bc: Pushed<br>58e68352ccbd: Pushed<br>df64d3292fd6: Mounted from library/alpine<br>v1: digest: sha256:be0cbe0fd7290ac017745473fafabf611eaaf026f6a5d5b5fbd7a21a6fa7754f size: 1158</em></strong></span></pre><p id="b9be" class="ms mt dg bt mu b mv nm mx nn mz no nb np nd nq nf" data-selectable-paragraph="">And this is the reflection of the above action on the Docker Hub (the public Docker Registry):</p><p data-selectable-paragraph=""><img src="https://miro.medium.com/max/850/1*QLhuuf-wijXfO3-FlgWvBA.png" data-is-external-image="true" alt="Docker Hub stores public images of containers" width="425" height="317"></p><p>Docker Hub stores public images of containers</p><p> </p><p><img src="https://miro.medium.com/max/850/1*KXf0iKuqNb0W4FcQKsc-WQ.png" data-is-external-image="true" alt="Detail on the container creation. Pay attention to the badges at the bottom left" width="425" height="235"></p><p>Detail on the container creation. Pay attention to the badges at the bottom left</p><p> </p><p><img src="https://miro.medium.com/max/854/1*YxWymOTw4GMkLqCWz8T6tg.png" data-is-external-image="true" alt="Size detail on the content recently created" width="427" height="228"></p><p> Size detail on the content recently created</p><p> </p><p><img src="https://miro.medium.com/max/850/1*EuTSq7g4KqQUej80-jm4AA.png" data-is-external-image="true" alt="Metadata detail on container composition" width="425" height="407"></p><p>Metadata detail on container composition</p><h2>Colophon</h2><p id="62f8" class="ms mt dg bt mu b mv mw mx my mz na nb nc nd ne nf" data-selectable-paragraph="">Writing this article was an interesting experience. Writing for newcomers is difficult, more than for experienced professionals, but, this is the more rewarding, in my humble opinion. Hope this article served you.</p></div><aside class="post__aside"><div class="post__last-updated u-small">This article was updated on 12/08/2019</div><div class="post__share"><a href="https://twitter.com/share?url=https%3A%2F%2F0x30.io%2Fpython-restful-apis-running-on-containers-the-easy-way%2F&amp;via=ea1het&amp;text=Python%20RESTful%20APIs%20running%20on%20containers%2C%20the%20easy%20way" class="js-share twitter" title="Share with Twitter" rel="nofollow noopener noreferrer" aria-label="Share with Twitter"><svg class="u-icon"><use xlink:href="https://0x30.io/assets/svg/svg-map.svg#twitter"/></svg> </a><a href="http://www.linkedin.com/shareArticle?url=https%3A%2F%2F0x30.io%2Fpython-restful-apis-running-on-containers-the-easy-way%2F&amp;title=Python%20RESTful%20APIs%20running%20on%20containers%2C%20the%20easy%20way" class="js-share linkedin" title="Share with LinkedIn" rel="nofollow noopener noreferrer" aria-label="Share with LinkedIn"><svg class="u-icon"><use xlink:href="https://0x30.io/assets/svg/svg-map.svg#linkedin"/></svg></a></div></aside><footer class="post__footer"><ul class="post__tag box"><li><a href="https://0x30.io/tags/devops/" class="u-tag u-tag--1" title="DevOps">DevOps</a></li><li><a href="https://0x30.io/tags/professional/" class="u-tag u-tag--1" title="Professional">Professional</a></li><li><a href="https://0x30.io/tags/software/" class="u-tag u-tag--1" title="Software">Software</a></li></ul><nav class="post__nav box"><div class="post__nav__prev"><a href="https://0x30.io/microservices-101/" class="post__nav__link" rel="prev"><img class="lazyload" data-src="https://0x30.io/media/posts/13/responsive/microservices-xs.png" data-srcset="https://0x30.io/media/posts/13/responsive/microservices-xs.png" data-expand="300" alt=""><div class="u-small">Previous Post<h5>Microservices 101</h5></div></a></div><div class="post__nav__next"><a href="https://0x30.io/security-kpis/" class="post__nav__link" rel="next"><div class="u-small">Next Post<h5>Security KPIs</h5></div><img class="lazyload" data-src="https://0x30.io/media/posts/8/responsive/security_ciso-100593407-primary.idge-xs.jpg" data-srcset="https://0x30.io/media/posts/8/responsive/security_ciso-100593407-primary.idge-xs.jpg" data-expand="300" alt=""></a></div></nav></footer></article></main><div class="sidebar"><section class="box authors"><h3 class="box__title">Authors</h3><ul class="authors__cotainer"><li class="authors__item"><a href="https://0x30.io/authors/ea1het/" class="authors__image-link"><img data-src="https://0x30.io/media/website/avatar_010-150x150.png" class="lazyload" alt="Jonathan Gonzalez"></a><div><a href="https://0x30.io/authors/ea1het/" class="authors__title">Jonathan Gonzalez</a> <span class="u-small">Post: 10</span></div></li></ul></section><section class="box"><h3 class="box__title">Tags</h3><ul class="tags"><li><a href="https://0x30.io/tags/cybersecurity/">CyberSecurity</a> <span class="u-small">(3)</span></li><li><a href="https://0x30.io/tags/data/">Data</a> <span class="u-small">(2)</span></li><li><a href="https://0x30.io/tags/devops/">DevOps</a> <span class="u-small">(5)</span></li><li><a href="https://0x30.io/tags/hobby/">Hobby</a> <span class="u-small">(2)</span></li><li><a href="https://0x30.io/tags/iot/">IoT</a> <span class="u-small">(2)</span></li><li><a href="https://0x30.io/tags/professional/">Professional</a> <span class="u-small">(8)</span></li><li><a href="https://0x30.io/tags/software/">Software</a> <span class="u-small">(5)</span></li></ul></section></div><footer class="footer"><a class="footer__logo" href="https://0x30.io/">EA1HET / 0x30.io</a><nav><ul class="footer__nav"></ul></nav><div class="footer__copyright">This site is powered by Publii, the FOSS CMS for static websites</div></footer></div><script>window.publiiThemeMenuConfig = {    
        mobileMenuMode: 'sidebar',
        animationSpeed: 300,
        submenuWidth: 'auto',
        doubleClickTime: 500,
        mobileMenuExpandableSubmenus: true, 
        relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script defer="defer" src="https://0x30.io/assets/js/scripts.min.js?v=225cfb4a7e546edee710c4f1208e81e2"></script></body></html>