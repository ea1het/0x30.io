<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>The ESP8266 hardware - EA1HET / 0x30.io</title><meta name="description" content="While the ESP8266 is often used as a ‘dumb’ Serial-to-WiFi bridge, it’s a very powerful&hellip;"><meta name="robots" content="index, follow"><link rel="canonical" href="https://0x30.io/the-esp8266-hardware/"><link rel="amphtml" href="https://0x30.io/amp/the-esp8266-hardware/"><link rel="alternate" type="application/atom+xml" href="https://0x30.io/feed.xml"><link rel="alternate" type="application/json" href="https://0x30.io/feed.json"><link rel="shortcut icon" href="https://0x30.io/media/website/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="https://0x30.io/assets/css/style.css?v=a230e4faf88acd31009720df09d89932"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://0x30.io/the-esp8266-hardware/"},"headline":"The ESP8266 hardware","datePublished":"2019-08-14T12:11","dateModified":"2019-08-14T12:38","image":{"@type":"ImageObject","url":"https://0x30.io/media/posts/14/kisscc0-esp8266-arduino-wi-fi-input-output-computer-icons-esp01-like-wifi-module-5b748100ac8846.2815384415343618567067.png","height":750,"width":1281},"description":"While the ESP8266 is often used as a ‘dumb’ Serial-to-WiFi bridge, it’s a very powerful&hellip;","author":{"@type":"Person","name":"Jonathan Gonzalez"},"publisher":{"@type":"Organization","name":"Jonathan Gonzalez"}}</script></head><body><div class="container"><header class="top"><a class="logo" href="https://0x30.io/">EA1HET / 0x30.io</a><nav class="navbar js-navbar"><button class="navbar__toggle js-navbar__toggle">Menu</button><ul class="navbar__menu"><li><a href="https://0x30.io/" title="Home">Home</a></li><li class="has-submenu"><span>Professional</span><ul class="navbar__submenu"><li><a href="https://0x30.io/tags/cybersecurity/">CyberSecurity</a></li><li><a href="https://0x30.io/tags/devops/">DevOps</a></li><li><a href="https://0x30.io/tags/data/">Data</a></li></ul></li><li class="has-submenu"><span>Amateur</span><ul class="navbar__submenu"><li><a href="https://0x30.io/ham-radio-software/">Ham Radio software</a></li><li><a href="https://0x30.io/tags/iot/">IoT</a></li></ul></li><li><a href="https://0x30.io/ham-radio/">Ham Radio</a></li><li><a href="https://0x30.io/about-me/">About me</a></li><li><a href="https://0x30.io/feed">Feed</a></li></ul></nav></header><main class="main"><article class="post"><header><h1>The ESP8266 hardware</h1><ul class="post__meta u-small"><li><a href="https://0x30.io/authors/ea1het/" rel="author" title="Jonathan Gonzalez">Jonathan Gonzalez</a></li><li>Published on <time datetime="2019-08-14T12:11">14/08/2019</time></li><li><a href="https://0x30.io/tags/hobby/" title="Hobby">Hobby</a></li></ul><figure><img src="https://0x30.io/media/posts/14/kisscc0-esp8266-arduino-wi-fi-input-output-computer-icons-esp01-like-wifi-module-5b748100ac8846.2815384415343618567067.png" sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://0x30.io/media/posts/14/responsive/kisscc0-esp8266-arduino-wi-fi-input-output-computer-icons-esp01-like-wifi-module-5b748100ac8846.2815384415343618567067-xs.png 300w, https://0x30.io/media/posts/14/responsive/kisscc0-esp8266-arduino-wi-fi-input-output-computer-icons-esp01-like-wifi-module-5b748100ac8846.2815384415343618567067-sm.png 480w, https://0x30.io/media/posts/14/responsive/kisscc0-esp8266-arduino-wi-fi-input-output-computer-icons-esp01-like-wifi-module-5b748100ac8846.2815384415343618567067-md.png 768w, https://0x30.io/media/posts/14/responsive/kisscc0-esp8266-arduino-wi-fi-input-output-computer-icons-esp01-like-wifi-module-5b748100ac8846.2815384415343618567067-lg.png 1024w" alt=""></figure></header><div class="post__entry"><p>While the ESP8266 is often used as a ‘dumb’ Serial-to-WiFi bridge, it’s a very powerful microcontroller on its own. In this blog post, we’ll look at the non-Wi-Fi specific functions of the ESP8266.</p><h3>Digital I/O</h3><p>Just like a normal Arduino, the ESP8266 has digital input/output pins (I/O or GPIO, General Purpose Input/Output pins). As the name implies, they can be used as digital inputs to read a digital voltage, or as digital outputs to output either 0V (sink current) or 3.3V (source current).</p><h4>Voltage and current restrictions</h4><p>The ESP8266 is a 3.3V microcontroller, so its I/O operates at 3.3V as well. The pins are <strong>not 5V tolerant, applying more than 3.6V on any pin will kill the chip.</strong></p><p>The maximum current that can be drawn from a single GPIO pin is <strong>12mA</strong>.</p><h4>Usable pins</h4><p>The ESP8266 has 17 GPIO pins (0-16), however, you can only use 11 of them, because 6 pins (GPIO 6 - 11) are used to connect the flash memory chip. This is the small 8-legged chip right next to the ESP8266. If you try to use one of these pins, you might crash your program.</p><p>GPIO 1 and 3 are used as TX and RX of the hardware Serial port (UART), so in most cases, you can’t use them as normal I/O while sending/receiving serial data.</p><h4>Boot modes</h4><p>As mentioned in the previous chapter, some I/O pins have a special function during boot: They select 1 of 3 boot modes:</p><table><thead><tr><th>GPIO15</th><th>GPIO0</th><th>GPIO2</th><th>Mode</th></tr></thead><tbody><tr><td>0V</td><td>0V</td><td>3.3V</td><td>Uart Bootloader</td></tr><tr><td>0V</td><td>3.3V</td><td>3.3V</td><td>Boot sketch (SPI flash)</td></tr><tr><td>3.3V</td><td>x</td><td>x</td><td>SDIO mode (not used for Arduino)</td></tr></tbody></table><p>Note: you don’t have to add an external pull-up resistor to GPIO2, the internal one is enabled at boot.</p><p>We made sure that these conditions are met by adding external resistors in the previous chapter, or the board manufacturer of your board added them for you. This has some implications, however:</p><ul><li>GPIO15 is always pulled low, so you can’t use the internal pull-up resistor. You have to keep this in mind when using GPIO15 as an input to read a switch or connect it to a device with an open-collector (or open-drain) output, like I²C.</li><li>GPIO0 is pulled high during normal operation, so you can’t use it as a Hi-Z input.</li><li>GPIO2 can’t be low at boot, so you can’t connect a switch to it.</li></ul><h4>Internal pull-up/-down resistors</h4><p>GPIO 0-15 all have a built-in pull-up resistor, just like in an Arduino. GPIO16 has a built-in pull-down resistor.</p><h4>PWM</h4><p>Unlike most Atmel chips (Arduino), the ESP8266 doesn’t support hardware PWM, however, software PWM is supported on all digital pins. The default PWM range is 10-bits @ 1kHz, but this can be changed (up to &gt;14-bit@1kHz).</p><h3>Analog input</h3><p>The ESP8266 has a single analog input, with an input range of 0 - 1.0V. If you supply 3.3V, for example, you will damage the chip. Some boards like the NodeMCU have an on-board resistive voltage divider, to get an easier 0 - 3.3V range. You could also just use a trimpot as a voltage divider.</p><p>The ADC (analog to digital converter) has a resolution of 10 bits.</p><h3>Communication</h3><h4>Serial</h4><p>The ESP8266 has two hardware UARTS (Serial ports):<br>UART0 on pins 1 and 3 (TX0 and RX0 resp.), and UART1 on pins 2 and 8 (TX1 and RX1 resp.), however, GPIO8 is used to connect the flash chip. This means that UART1 can only transmit data.</p><p>UART0 also has hardware flow control on pins 15 and 13 (RTS0 and CTS0 resp.). These two pins can also be used as alternative TX0 and RX0 pins.</p><h4>I²C</h4><p>The ESP doesn’t have a hardware TWI (Two Wire Interface), but it is implemented in software. This means that you can use pretty much any two digital pins. By default, the I²C library uses pin 4 as SDA and pin 5 as SCL. (The data sheet specifies GPIO2 as SDA and GPIO14 as SCL.) The maximum speed is approximately 450kHz.</p><h4>SPI</h4><p>The ESP8266 has one SPI connection available to the user, referred to as HSPI. It uses GPIO14 as CLK, 12 as MISO, 13 as MOSI and 15 as Slave Select (SS). It can be used in both Slave and Master mode (in software).</p><h3>GPIO overview</h3><table><thead><tr><th>GPIO</th><th>Function</th><th>State</th><th>Restrictions</th></tr></thead><tbody><tr><td>0</td><td>Boot mode select</td><td>3.3V</td><td>No Hi-Z</td></tr><tr><td>1</td><td>TX0</td><td>-</td><td>Not usable during Serial transmission</td></tr><tr><td>2</td><td>Boot mode select<br>TX1</td><td>3.3V (boot only)</td><td>Don’t connect to ground at boot time <br>Sends debug data at boot time</td></tr><tr><td>3</td><td>RX0</td><td>-</td><td>Not usable during Serial transmission</td></tr><tr><td>4</td><td>SDA (I²C)</td><td>-</td><td>-</td></tr><tr><td>5</td><td>SCL (I²C)</td><td>-</td><td>-</td></tr><tr><td>6 - 11</td><td>Flash connection</td><td>x</td><td>Not usable, and not broken out</td></tr><tr><td>12</td><td>MISO (SPI)</td><td>-</td><td>-</td></tr><tr><td>13</td><td>MOSI (SPI)</td><td>-</td><td>-</td></tr><tr><td>14</td><td>SCK (SPI)</td><td>-</td><td>-</td></tr><tr><td>15</td><td>SS (SPI)</td><td>0V</td><td>Pull-up resistor not usable</td></tr><tr><td>16</td><td>Wake up from sleep</td><td>-</td><td>No pull-up resistor, but pull-down instead <br>Should be connected to RST to wake up</td></tr></tbody></table><h2>The ESP8266 as a microcontroller: The software</h2><p>Most of the microcontroller functionality of the ESP uses exactly the same syntax as a normal Arduino, making it really easy to get started.</p><h3>Digital I/O</h3><p>Just like with a regular Arduino, you can set the function of a pin using <code>pinMode(pin, mode);</code> where <code>pin</code> is the GPIO number*, and <code>mode</code> can be either <code>INPUT</code>, which is the default, <code>OUTPUT</code>, or <code>INPUT_PULLUP</code> to enable the built-in pull-up resistors for GPIO 0-15. To enable the pull-down resistor for GPIO16, you have to use <code>INPUT_PULLDOWN_16</code>.</p><p>(*) NodeMCU uses a different pin mapping, read more <a href="https://github.com/esp8266/Arduino/blob/master/doc/boards.md#nodemcu-09">here</a>. To address a NodeMCU pin, e.g. pin 5, use D5: for instance: <code>pinMode(D5, OUTPUT);</code></p><p>To set an output pin high (3.3V) or low (0V), use <code>digitalWrite(pin, value);</code> where <code>pin</code> is the digital pin, and <code>value</code> either 1 or 0 (or <code>HIGH</code> and <code>LOW</code>).</p><p>To read an input, use <code>digitalRead(pin);</code></p><p>To enable PWM on a certain pin, use <code>analogWrite(pin, value);</code> where <code>pin</code> is the digital pin, and <code>value</code> a number between 0 and 1023.</p><p>You can change the range (bit depth) of the PWM output by using <code>analogWriteRange(new_range);</code></p><p>The frequency can be changed by using <code>analogWriteFreq(new_frequency);</code>. <code>new_frequency</code> should be between 100 and 1000Hz.</p><h3>Analog input</h3><p>Just like on an Arduino, you can use <code>analogRead(A0)</code> to get the analog voltage on the analog input. (0 = 0V, 1023 = 1.0V).</p><p>The ESP can also use the ADC to measure the supply voltage (V<sub>CC</sub>). To do this, include <code>ADC_MODE(ADC_VCC);</code> at the top of your sketch, and use <code>ESP.getVcc();</code> to actually get the voltage.<br>If you use it to read the supply voltage, you can’t connect anything else to the analog pin.</p><h3>Communication</h3><h4>Serial communication</h4><p>To use UART0 (TX = GPIO1, RX = GPIO3), you can use the <code>Serial</code> object, just like on an Arduino: <code>Serial.begin(baud)</code>.</p><p>To use the alternative pins (TX = GPIO15, RX = GPIO13), use <code>Serial.swap()</code> after <code>Serial.begin</code>.</p><p>To use UART1 (TX = GPIO2), use the <code>Serial1</code> object.</p><p>All Arduino Stream functions, like <code>read, write, print, println, ...</code> are supported as well.</p><h4>I²C and SPI</h4><p>You can just use the default Arduino library syntax, like you normally would.</p><h3>Sharing CPU time with the RF part</h3><p>One thing to keep in mind while writing programs for the ESP8266 is that your sketch has to share resources (CPU time and memory) with the Wi-Fi- and TCP-stacks (the software that runs in the background and handles all Wi-Fi and IP connections). <br>If your code takes too long to execute, and don’t let the TCP stacks do their thing, it might crash, or you could lose data. It’s best to keep the execution time of you loop under a couple of hundreds of milliseconds.</p><p>Every time the main loop is repeated, your sketch yields to the Wi-Fi and TCP to handle all Wi-Fi and TCP requests.</p><p>If your loop takes longer than this, you will have to explicitly give CPU time to the Wi-Fi/TCP stacks, by using including <code>delay(0);</code> or <code>yield();</code>. If you don’t, network communication won’t work as expected, and if it’s longer than 3 seconds, the soft WDT (Watch Dog Timer) will reset the ESP. If the soft WDT is disabled, after a little over 8 seconds, the hardware WDT will reset the chip.</p><p>From a microcontroller’s perspective however, 3 seconds is a very long time (240 million clockcycles), so unless you do some extremely heavy number crunching, or sending extremely long strings over Serial, you won’t be affected by this. Just keep in mind that you add the <code>yield();</code> inside your <code>for</code> or <code>while</code> loops that could take longer than, say 100ms.</p><h3>References</h3><p>This is where I got most of the information to write this blog post There’s some more details on the GitHub pages, if you’re into some more advanced stuff, like EEPROM or deep sleep etc...</p><ul><li><a href="https://github.com/esp8266/Arduino/issues/2942">https://github.com/esp8266/Arduino/issues/2942</a></li><li><a href="https://github.com/esp8266/Arduino/pull/2533/files">https://github.com/esp8266/Arduino/pull/2533/files</a></li><li><a href="https://github.com/esp8266/Arduino/blob/master/doc/libraries.md">https://github.com/esp8266/Arduino/blob/master/doc/libraries.md</a></li><li><a href="https://github.com/esp8266/Arduino/blob/master/doc/reference.md">https://github.com/esp8266/Arduino/blob/master/doc/reference.md</a></li><li><a href="https://github.com/esp8266/Arduino/blob/master/doc/boards.md">https://github.com/esp8266/Arduino/blob/master/doc/boards.md</a></li></ul></div><footer class="post__footer"><p class="post__last-updated">This article was updated on 14/08/2019</p><div class="post__share box"><h3 class="box__title">Share this:</h3><a href="https://twitter.com/share?url=https%3A%2F%2F0x30.io%2Fthe-esp8266-hardware%2F&amp;via=@ea1het&amp;text=The%20ESP8266%20hardware" class="js-share twitter" title="Share with Twitter" rel="nofollow"><svg class="u-icon" aria-hidden="true"><use xlink:href="https://0x30.io/assets/svg/svg-map.svg#twitter"/></svg> Twitter </a><a href="http://www.linkedin.com/shareArticle?url=https%3A%2F%2F0x30.io%2Fthe-esp8266-hardware%2F&amp;title=The%20ESP8266%20hardware" class="js-share linkedin" title="Share with LinkedIn" rel="nofollow"><svg class="u-icon" aria-hidden="true"><use xlink:href="https://0x30.io/assets/svg/svg-map.svg#linkedin"/></svg> Linkedin </a><a href="https://buffer.com/add?text=The%20ESP8266%20hardware&amp;url=https%3A%2F%2F0x30.io%2Fthe-esp8266-hardware%2F" class="js-share buffer" title="Share with Buffer" rel="nofollow"><svg class="u-icon" aria-hidden="true"><use xlink:href="https://0x30.io/assets/svg/svg-map.svg#buffer"/></svg> Buffer</a></div><ul class="post__tag box"><h3 class="box__title">Tags:</h3><li><a href="https://0x30.io/tags/hobby/">Hobby</a></li><li><a href="https://0x30.io/tags/iot/">IoT</a></li><li><a href="https://0x30.io/tags/software/">Software</a></li></ul><nav class="post__nav box"><div class="post__nav__prev"><a href="https://0x30.io/application-security/" class="post__nav__link" rel="prev"><img src="https://0x30.io/media/posts/7/responsive/Dynamic-Application-Security-Test-Orchestration-1000x500-xs.jpg" alt=""><div class="post__nav__text">Previous Post<h5>Application Security</h5></div></a></div><div class="post__nav__next"><a href="https://0x30.io/esp8266-programming/" class="post__nav__link" rel="next"><div class="post__nav__text">Next Post<h5>ESP8266 programming</h5></div><img src="https://0x30.io/media/posts/15/responsive/0561d6e4dcd7a6b73f4d6cbdcf555161_original-xs.jpg" alt=""></a></div></nav><div class="post__related box"><h3 class="box__title">Related posts</h3><div class="post__related__wrap"><figure><a href="https://0x30.io/esp8266-programming/"><img src="https://0x30.io/media/posts/15/responsive/0561d6e4dcd7a6b73f4d6cbdcf555161_original-xs.jpg" alt=""></a><figcaption><h4><a href="https://0x30.io/esp8266-programming/">ESP8266 programming</a></h4><time datetime="2019-08-14T13:10">14/08/2019</time></figcaption></figure></div></div></footer></article></main><div class="sidebar"><section class="owner box box--gray"><h3 class="box__title">Owner</h3><img src="https://0x30.io/media/website/avatar_010-150x150.png" alt="Jonathan Gonzalez"><h4>Jonathan Gonzalez</h4><p><a href="mailto:j@0x30.io" class="owner__email">j@0x30.io</a></p></section><section class="box"><h3 class="box__title">Tags</h3><ul class="tags"><li><a href="https://0x30.io/tags/cybersecurity/">CyberSecurity</a> <span class="u-small">(3)</span></li><li><a href="https://0x30.io/tags/data/">Data</a> <span class="u-small">(2)</span></li><li><a href="https://0x30.io/tags/devops/">DevOps</a> <span class="u-small">(4)</span></li><li><a href="https://0x30.io/tags/hobby/">Hobby</a> <span class="u-small">(2)</span></li><li><a href="https://0x30.io/tags/iot/">IoT</a> <span class="u-small">(2)</span></li><li><a href="https://0x30.io/tags/professional/">Professional</a> <span class="u-small">(7)</span></li><li><a href="https://0x30.io/tags/software/">Software</a> <span class="u-small">(5)</span></li></ul></section><section class="box"><h3 class="box__title">Search</h3><form action="https://0x30.io/search.html" class="search"><input type="search" name="q" placeholder="search..."></form></section></div><footer class="footer u-small"><div class="footer__copyright">This site is powered by Publii, the FOSS CMS for static websites</div></footer></div><script>var loadCSSFiles = function() {
            var links = ['https://fonts.googleapis.com/css?family=PT+Serif|Roboto:400,700&amp;subset=latin-ext'],
                headElement = document.getElementsByTagName('head')[0],
                linkElement, i;
            for (i = 0; i < links.length; i++) {
                linkElement = document.createElement('link');
                linkElement.rel = 'stylesheet';
                linkElement.href = links[i];
                headElement.appendChild(linkElement);
            }
        };
        var raf = requestAnimationFrame || mozRequestAnimationFrame || webkitRequestAnimationFrame || msRequestAnimationFrame;
        if (raf) {
            raf(loadCSSFiles);
        } else {
            window.addEventListener('load', loadCSSFiles);
        }</script><script defer="defer" src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha256-k2WSCIexGzOj3Euiig+TlR8gA0EmPjuc79OEeY5L45g=" aria-dropeffect="" crossorigin="anonymous"></script><script defer="defer" src="https://0x30.io/assets/js/scripts.min.js?v=071da11d08d51699af4ef60371596ff9"></script><div class="cookie-popup js-cookie-popup cookie-popup--uses-badge"><h2>This website uses cookies</h2><p>Select which cookies to opt-in to via the checkboxes below; our website uses cookies to examine site traffic and user activity while on our site, for marketing, and to provide social media functionality. <a href="https://0x30.io/cookie-policy/">More details...</a></p><form><input id="gdpr-necessary" name="gdpr-necessary" checked="checked" disabled="disabled" type="checkbox"> <label for="gdpr-necessary">Required</label> <input id="gdpr-functions" name="gdpr-functions" type="checkbox"> <label for="gdpr-functions">Functionality</label> <input id="gdpr-analytics" name="gdpr-analytics" type="checkbox"> <label for="gdpr-analytics">Analytical</label> <input id="gdpr-marketing" name="gdpr-marketing" type="checkbox"> <label for="gdpr-marketing">Marketing</label><p class="cookie-popup__save-wrapper"><button type="submit" class="cookie-popup__save">Save</button></p></form><span class="cookie-popup-label">Cookie Policy</span></div><script>(function() {
                function addScript (src, inline) {
                    var newScript = document.createElement('script');

                    if (src) {
                        newScript.setAttribute('src', src);
                    }

                    if (inline) {
                        newScript.text = inline;
                    }

                    document.body.appendChild(newScript);
                }

                var popup = document.querySelector('.js-cookie-popup');
                var checkboxes = popup.querySelectorAll('input[type="checkbox"]');
                var save = popup.querySelector('button');
                var currentConfig = localStorage.getItem('publii-gdpr-allowed-cookies');
                var blockedScripts = document.querySelectorAll('script[type^="gdpr-blocker/"]');
                

                popup.addEventListener('click', function() {
                    if (!popup.classList.contains('cookie-popup--is-sticky')) {
                        popup.classList.add('cookie-popup--is-sticky');
                    }
                });

                save.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    popup.classList.remove('cookie-popup--is-sticky');
                    var allowedGroups = [];

                    for (var i = 0; i < checkboxes.length; i++) {
                        if (checkboxes[i].checked) {
                            var groupName = checkboxes[i].getAttribute('name').replace('gdpr-', '');
                            var scripts = document.querySelectorAll('script[type="gdpr-blocker/' + groupName + '"]');

                            for (var j = 0; j < scripts.length; j++) {
                                addScript(scripts[j].src, scripts[j].text);
                            }

                            allowedGroups.push(groupName);
                        }
                    }

                    localStorage.setItem('publii-gdpr-allowed-cookies', allowedGroups.join(','));
                    popup.classList.remove('cookie-popup--is-sticky');

                    setTimeout(function () {
                        if (currentConfig !== null) {
                            window.location.reload();
                        }
                    }, 250);
                });

                if (currentConfig === null) {
                    popup.classList.add('cookie-popup--is-sticky');
                } else {
                    if (currentConfig !== '') {
                        var allowedGroups = currentConfig.split(',');

                        for (var i = 0; i < allowedGroups.length; i++) {
                            var scripts = document.querySelectorAll('script[type="gdpr-blocker/' + allowedGroups[i] + '"]');
                            var checkbox = popup.querySelector('input[type="checkbox"][name="gdpr-' + allowedGroups[i] + '"]');

                            if (checkbox) {
                                checkbox.checked = true;
                            }

                            for (var j = 0; j < scripts.length; j++) {
                                addScript(scripts[j].src, scripts[j].text);
                            }
                        }
                    }
                }
            })();</script></body></html>